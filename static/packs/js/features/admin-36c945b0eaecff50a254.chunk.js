"use strict";(self.webpackChunksoapbox_fe=self.webpackChunksoapbox_fe||[]).push([[9],{821:function(t,e,n){n.r(e),n.d(e,{default:function(){return v}});var a,o,i=n(1019),r=n(0),s=n(1021),c=n(2),l=n(1800),u=n(8),d=n(179),p=(a=function(t,e){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},a(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),v=(0,c.$j)((function(t,e){return{instance:t.get("instance"),approvalCount:t.getIn(["admin","awaitingApproval"]).count(),reportsCount:t.getIn(["admin","openReports"]).count()}}))(o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.render=function(){var t=this.props,e=t.instance,a=t.approvalCount,o=t.reportsCount;return r.createElement(r.Fragment,null,(0,i.Z)("div",{className:"wtf-panel promo-panel"},void 0,(0,i.Z)("div",{className:"promo-panel__container"},void 0,(0,i.Z)(l.OL,{className:"promo-panel-item",to:"/admin"},void 0,(0,i.Z)(u.Z,{src:n(255),className:"promo-panel-item__icon"}),(0,i.Z)(s.Z,{id:"admin_nav.dashboard",defaultMessage:"Dashboard"})),(0,i.Z)(l.OL,{className:"promo-panel-item",to:"/admin/reports"},void 0,(0,i.Z)(d.Z,{src:n(274),count:o}),(0,i.Z)(s.Z,{id:"admin_nav.reports",defaultMessage:"Reports"})),(e.get("registrations")&&e.get("approval_required")||a>0)&&(0,i.Z)(l.OL,{className:"promo-panel-item",to:"/admin/approval"},void 0,(0,i.Z)(d.Z,{src:n(192),count:a}),(0,i.Z)(s.Z,{id:"admin_nav.awaiting_approval",defaultMessage:"Awaiting Approval"})))))},e}(r.PureComponent))||o},1122:function(t,e,n){n.r(e),n.d(e,{default:function(){return E}});var a,o=n(1015),i=n(1020),r=n(1018),s=(n(1),n(320)),c=n(3),l=n.n(c),u=n(0),d=n(5),p=n.n(d),v=n(4),f=n(1797),m=n(1017),h=n(2),Z=n(38),_=n(1264),g=n(1019),b=n(1800),y=n(8),w=n(46),N=(a=function(t,e){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},a(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),M=["title","icon","accountIds","limit","total","expandMessage","expandRoute"],O=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return N(e,t),e.prototype.render=function(){var t=this.props,e=t.title,n=t.icon,a=t.accountIds,r=t.limit,s=t.total,c=t.expandMessage,l=t.expandRoute,d=(0,i.Z)(t,M);if(!a||a.isEmpty())return null;var p=c&&l&&a.size<s;return(0,g.Z)("div",{className:"wtf-panel"},void 0,(0,g.Z)("div",{className:"wtf-panel-header"},void 0,(0,g.Z)(y.Z,{src:n,className:"wtf-panel-header__icon"}),(0,g.Z)("span",{className:"wtf-panel-header__label"},void 0,e)),(0,g.Z)("div",{className:"wtf-panel__content"},void 0,(0,g.Z)("div",{className:"wtf-panel__list"},void 0,a.take(r).map((function(t){return u.createElement(w.Z,(0,o.Z)({key:t,id:t},d))})))),p&&(0,g.Z)(b.rU,{className:"wtf-panel__expand-btn",to:l},void 0,c))},e}(v.ZP),C=O;(0,r.Z)(O,"propTypes",{title:l().node.isRequired,accountIds:p().orderedSet.isRequired,icon:l().string.isRequired,limit:l().number,total:l().number,expandMessage:l().string,expandRoute:l().string}),(0,r.Z)(O,"defaultProps",{limit:1/0});var k,P,j,R=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),x=["intl","accountIds","limit","isSorted"],I=(0,f.vU)({title:{id:"admin.latest_accounts_panel.title",defaultMessage:"Latest Accounts"},expand:{id:"admin.latest_accounts_panel.expand_message",defaultMessage:"Click to see {count} more {count, plural, one {account} other {accounts}}"}}),E=(0,h.$j)((function(t){var e=t.getIn(["admin","latestUsers"]),n=e.sort(_.Z).reverse();return{isSorted:e.every((function(e){return t.getIn(["accounts",e,"created_at"])}))&&(0,s.is)(e,n),accountIds:e}}))(k=(0,m.ZP)((j=P=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var a=t.apply(this,e)||this;return(0,r.Z)(a,"state",{total:0}),a}return R(e,t),e.prototype.componentDidMount=function(){var t=this,e=this.props,n=e.dispatch,a=e.limit;n((0,Z.uh)(["local","active"],1,null,a)).then((function(e){var n=e.count;t.setState({total:n})})).catch((function(){}))},e.prototype.render=function(){var t=this.props,e=t.intl,a=t.accountIds,r=t.limit,s=t.isSorted,c=(0,i.Z)(t,x),l=this.state.total;if(!s||!a||a.isEmpty())return null;var d=l-a.size;return u.createElement(C,(0,o.Z)({icon:n(181),title:e.formatMessage(I.title),accountIds:a,limit:r,total:l,expandMessage:e.formatMessage(I.expand,{count:d}),expandRoute:"/admin/users",withDate:!0,withRelationship:!1},c))},e}(v.ZP),(0,r.Z)(P,"propTypes",{accountIds:p().orderedSet.isRequired,limit:l().number}),(0,r.Z)(P,"defaultProps",{limit:5}),k=j))||k)||k},533:function(t,e,n){n.r(e),n.d(e,{default:function(){return D}});var a=n(1019),o=n(1018),i=(n(1),n(53),n(3)),r=n.n(i),s=n(5),c=n.n(s),l=n(4),u=n(1797),d=n(1017),p=n(1021),v=n(2),f=n(1800),m=n(13);function h(){return function(t,e){return(0,m.ZP)(e).get("/api/v1/pleroma/admin/email_list/subscribers.csv")}}function Z(){return function(t,e){return(0,m.ZP)(e).get("/api/v1/pleroma/admin/email_list/unsubscribers.csv")}}function _(){return function(t,e){return(0,m.ZP)(e).get("/api/v1/pleroma/admin/email_list/combined.csv")}}var g,b,y,w,N,M=n(17),O=n(112),C=n.n(O),k=n(10),P=n(1254),j=n(16),R=n(38),x=n(30),I=n(28),E=(g=function(t,e){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},g(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}g(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),S=(0,u.vU)({saved:{id:"admin.dashboard.settings_saved",defaultMessage:"Settings saved!"}}),A=function(t){return[{group:":pleroma",key:":instance",value:{open:[{tuple:[":registrations_open",!0]},{tuple:[":account_approval_required",!1]}],approval:[{tuple:[":registrations_open",!0]},{tuple:[":account_approval_required",!0]}],closed:[{tuple:[":registrations_open",!1]}]}[t]}]},U=(0,v.$j)((function(t,e){return{mode:(n=t.get("instance"),n.get("approval_required")&&n.get("registrations")?"approval":n.get("registrations")?"open":"closed")};var n}))(b=(0,d.ZP)(b=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var a=t.apply(this,e)||this;return(0,o.Z)(a,"onChange",(function(t){var e=a.props,n=e.dispatch,o=e.intl,i=A(t.target.value);n((0,R.rF)(i)).then((function(){n(x.ZP.success(o.formatMessage(S.saved)))})).catch((function(){}))})),a}return E(e,t),e.prototype.render=function(){var t=this.props.mode;return(0,a.Z)(I.NA,{},void 0,(0,a.Z)(I.H_,{},void 0,(0,a.Z)(I.Ee,{label:(0,a.Z)(p.Z,{id:"admin.dashboard.registration_mode_label",defaultMessage:"Registrations"}),onChange:this.onChange},void 0,(0,a.Z)(I.Rk,{label:(0,a.Z)(p.Z,{id:"admin.dashboard.registration_mode.open_label",defaultMessage:"Open"}),hint:(0,a.Z)(p.Z,{id:"admin.dashboard.registration_mode.open_hint",defaultMessage:"Anyone can join."}),checked:"open"===t,value:"open"}),(0,a.Z)(I.Rk,{label:(0,a.Z)(p.Z,{id:"admin.dashboard.registration_mode.approval_label",defaultMessage:"Approval Required"}),hint:(0,a.Z)(p.Z,{id:"admin.dashboard.registration_mode.approval_hint",defaultMessage:"Users can sign up, but their account only gets activated when an admin approves it."}),checked:"approval"===t,value:"approval"}),(0,a.Z)(I.Rk,{label:(0,a.Z)(p.Z,{id:"admin.dashboard.registration_mode.closed_label",defaultMessage:"Closed"}),hint:(0,a.Z)(p.Z,{id:"admin.dashboard.registration_mode.closed_hint",defaultMessage:"Nobody can sign up. You can still invite people."}),checked:"closed"===t,value:"closed"}))))},e}(l.ZP))||b)||b,q=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),L=function(t,e){var n=URL.createObjectURL(new Blob([t.data])),a=document.createElement("a");a.href=n,a.setAttribute("download",e),document.body.appendChild(a),a.click(),a.remove()},T=(0,u.vU)({heading:{id:"column.admin.dashboard",defaultMessage:"Dashboard"}}),D=(0,v.$j)((function(t,e){var n=t.get("me");return{instance:t.get("instance"),supportsEmailList:(0,k.N$)(t.get("instance")).emailList,account:t.getIn(["accounts",n])}}))(y=(0,d.ZP)((N=w=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var a=t.apply(this,e)||this;return(0,o.Z)(a,"handleSubscribersClick",(function(t){a.props.dispatch(h()).then((function(t){L(t,"subscribers.csv")})).catch((function(){})),t.preventDefault()})),(0,o.Z)(a,"handleUnsubscribersClick",(function(t){a.props.dispatch(Z()).then((function(t){L(t,"unsubscribers.csv")})).catch((function(){})),t.preventDefault()})),(0,o.Z)(a,"handleCombinedClick",(function(t){a.props.dispatch(_()).then((function(t){L(t,"combined.csv")})).catch((function(){})),t.preventDefault()})),a}return q(e,t),e.prototype.render=function(){var t=this.props,e=t.intl,n=t.instance,o=t.supportsEmailList,i=t.account,r=(0,k.wy)(n.get("version")),s=n.getIn(["stats","user_count"]),c=n.getIn(["pleroma","stats","mau"]),l=s&&c?Math.round(c/s*100):null;return i?(0,a.Z)(j.Z,{icon:"tachometer-alt",heading:e.formatMessage(T.heading)},void 0,(0,a.Z)("div",{className:"dashcounters"},void 0,c&&(0,a.Z)("div",{className:"dashcounter"},void 0,(0,a.Z)("div",{},void 0,(0,a.Z)("div",{className:"dashcounter__num"},void 0,(0,a.Z)(u.BK,{value:c})),(0,a.Z)("div",{className:"dashcounter__label"},void 0,(0,a.Z)(p.Z,{id:"admin.dashcounters.mau_label",defaultMessage:"monthly active users"})))),(0,a.Z)("div",{className:"dashcounter"},void 0,(0,a.Z)(f.rU,{to:"/admin/users"},void 0,(0,a.Z)("div",{className:"dashcounter__num"},void 0,(0,a.Z)(u.BK,{value:s})),(0,a.Z)("div",{className:"dashcounter__label"},void 0,(0,a.Z)(p.Z,{id:"admin.dashcounters.user_count_label",defaultMessage:"total users"})))),(0,P.hj)(l)&&(0,a.Z)("div",{className:"dashcounter"},void 0,(0,a.Z)("div",{},void 0,(0,a.Z)("div",{className:"dashcounter__num"},void 0,l,"%"),(0,a.Z)("div",{className:"dashcounter__label"},void 0,(0,a.Z)(p.Z,{id:"admin.dashcounters.retention_label",defaultMessage:"user retention"})))),(0,a.Z)("div",{className:"dashcounter"},void 0,(0,a.Z)(f.rU,{to:"/timeline/local"},void 0,(0,a.Z)("div",{className:"dashcounter__num"},void 0,(0,a.Z)(u.BK,{value:n.getIn(["stats","status_count"])})),(0,a.Z)("div",{className:"dashcounter__label"},void 0,(0,a.Z)(p.Z,{id:"admin.dashcounters.status_count_label",defaultMessage:"posts"})))),(0,a.Z)("div",{className:"dashcounter"},void 0,(0,a.Z)("div",{},void 0,(0,a.Z)("div",{className:"dashcounter__num"},void 0,(0,a.Z)(u.BK,{value:n.getIn(["stats","domain_count"])})),(0,a.Z)("div",{className:"dashcounter__label"},void 0,(0,a.Z)(p.Z,{id:"admin.dashcounters.domain_count_label",defaultMessage:"peers"}))))),(0,M.GJ)(i)&&(0,a.Z)(U,{}),(0,a.Z)("div",{className:"dashwidgets"},void 0,(0,a.Z)("div",{className:"dashwidget"},void 0,(0,a.Z)("h4",{},void 0,(0,a.Z)(p.Z,{id:"admin.dashwidgets.software_header",defaultMessage:"Software"})),(0,a.Z)("ul",{},void 0,(0,a.Z)("li",{},void 0,C().displayName," ",(0,a.Z)("span",{className:"pull-right"},void 0,C().version)),(0,a.Z)("li",{},void 0,r.software," ",(0,a.Z)("span",{className:"pull-right"},void 0,r.version)))),o&&(0,M.GJ)(i)&&(0,a.Z)("div",{className:"dashwidget"},void 0,(0,a.Z)("h4",{},void 0,(0,a.Z)(p.Z,{id:"admin.dashwidgets.email_list_header",defaultMessage:"Email list"})),(0,a.Z)("ul",{},void 0,(0,a.Z)("li",{},void 0,(0,a.Z)("a",{href:"#",onClick:this.handleSubscribersClick,target:"_blank"},void 0,"subscribers.csv")),(0,a.Z)("li",{},void 0,(0,a.Z)("a",{href:"#",onClick:this.handleUnsubscribersClick,target:"_blank"},void 0,"unsubscribers.csv")),(0,a.Z)("li",{},void 0,(0,a.Z)("a",{href:"#",onClick:this.handleCombinedClick,target:"_blank"},void 0,"combined.csv")))))):null},e}(l.ZP),(0,o.Z)(w,"propTypes",{intl:r().object.isRequired,instance:c().map.isRequired,supportsEmailList:r().bool,account:c().map}),y=N))||y)||y}}]);
//# sourceMappingURL=admin-36c945b0eaecff50a254.chunk.js.map