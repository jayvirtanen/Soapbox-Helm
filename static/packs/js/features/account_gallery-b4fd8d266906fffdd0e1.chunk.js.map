{"version":3,"file":"packs/js/features/account_gallery-b4fd8d266906fffdd0e1.chunk.js","mappings":"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","sources":["webpack://soapbox-fe/./app/soapbox/features/account_gallery/components/media_item.js","webpack://soapbox-fe/./app/soapbox/features/account_gallery/index.js","webpack://soapbox-fe/./app/soapbox/features/ui/components/profile_media_panel.js"],"sourcesContent":["import _extends from\"@babel/runtime/helpers/esm/extends\";import _jsx from\"@babel/runtime/helpers/esm/jsx\";import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";var _dec,_class,_class2,_temp;import\"core-js/modules/web.dom-collections.iterator.js\";import classNames from'classnames';import PropTypes from'prop-types';import React from'react';import ImmutablePropTypes from'react-immutable-proptypes';import ImmutablePureComponent from'react-immutable-pure-component';import{connect}from'react-redux';import{getSettings}from'soapbox/actions/settings';import Blurhash from'soapbox/components/blurhash';import Icon from'soapbox/components/icon';import StillImage from'soapbox/components/still_image';import{isIOS}from'soapbox/is_mobile';const mapStateToProps=state=>({autoPlayGif:getSettings(state).get('autoPlayGif'),displayMedia:getSettings(state).get('displayMedia')});let MediaItem=(_dec=connect(mapStateToProps),_dec(_class=(_temp=_class2=class MediaItem extends ImmutablePureComponent{constructor(...args){super(...args);_defineProperty(this,\"state\",{visible:this.props.displayMedia!=='hide_all'&&!this.props.attachment.getIn(['status','sensitive'])||this.props.displayMedia==='show_all',loaded:false});_defineProperty(this,\"handleImageLoad\",()=>{this.setState({loaded:true});});_defineProperty(this,\"handleMouseEnter\",e=>{if(this.hoverToPlay()){e.target.play();}});_defineProperty(this,\"handleMouseLeave\",e=>{if(this.hoverToPlay()){e.target.pause();e.target.currentTime=0;}});_defineProperty(this,\"hoverToPlay\",()=>{const{autoPlayGif}=this.props;return!autoPlayGif&&['gifv','video'].indexOf(this.props.attachment.get('type'))!==-1;});_defineProperty(this,\"handleClick\",e=>{if(e.button===0&&!(e.ctrlKey||e.metaKey)){e.preventDefault();if(this.state.visible){this.props.onOpenMedia(this.props.attachment);}else{this.setState({visible:true});}}});}render(){const{attachment,displayWidth,autoPlayGif}=this.props;const{visible,loaded}=this.state;const width=\"\".concat(Math.floor((displayWidth-4)/3)-4,\"px\");const height=width;const status=attachment.get('status');const title=status.get('spoiler_text')||attachment.get('description');let thumbnail='';let icon;if(attachment.get('type')==='unknown'){// Skip\n}else if(attachment.get('type')==='image'){const focusX=attachment.getIn(['meta','focus','x'])||0;const focusY=attachment.getIn(['meta','focus','y'])||0;const x=(focusX/2+.5)*100;const y=(focusY/-2+.5)*100;thumbnail=/*#__PURE__*/_jsx(StillImage,{src:attachment.get('preview_url'),alt:attachment.get('description'),style:{objectPosition:\"\".concat(x,\"% \").concat(y,\"%\")}});}else if(['gifv','video'].indexOf(attachment.get('type'))!==-1){const conditionalAttributes={};if(isIOS()){conditionalAttributes.playsInline='1';}if(autoPlayGif){conditionalAttributes.autoPlay='1';}thumbnail=/*#__PURE__*/_jsx(\"div\",{className:classNames('media-gallery__gifv',{autoplay:autoPlayGif})},void 0,/*#__PURE__*/React.createElement(\"video\",_extends({className:\"media-gallery__item-gifv-thumbnail\",\"aria-label\":attachment.get('description'),title:attachment.get('description'),role:\"application\",src:attachment.get('url'),onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,loop:true,muted:true},conditionalAttributes)),/*#__PURE__*/_jsx(\"span\",{className:\"media-gallery__gifv__label\"},void 0,\"GIF\"));}else if(attachment.get('type')==='audio'){const remoteURL=attachment.get('remote_url')||'';const fileExtensionLastIndex=remoteURL.lastIndexOf('.');const fileExtension=remoteURL.substr(fileExtensionLastIndex+1).toUpperCase();thumbnail=/*#__PURE__*/_jsx(\"div\",{className:\"media-gallery__item-thumbnail\"},void 0,/*#__PURE__*/_jsx(\"span\",{className:\"media-gallery__item__icons\"},void 0,/*#__PURE__*/_jsx(Icon,{id:\"volume-up\"})),/*#__PURE__*/_jsx(\"span\",{className:\"media-gallery__file-extension__label\"},void 0,fileExtension));}if(!visible){icon=/*#__PURE__*/_jsx(\"span\",{className:\"account-gallery__item__icons\"},void 0,/*#__PURE__*/_jsx(Icon,{id:\"eye-slash\"}));}return/*#__PURE__*/_jsx(\"div\",{className:\"account-gallery__item\",style:{width,height}},void 0,/*#__PURE__*/_jsx(\"a\",{className:\"media-gallery__item-thumbnail\",href:status.get('url'),target:\"_blank\",onClick:this.handleClick,title:title},void 0,/*#__PURE__*/_jsx(Blurhash,{hash:attachment.get('blurhash'),className:classNames('media-gallery__preview',{'media-gallery__preview--hidden':visible&&loaded})}),visible&&thumbnail,!visible&&icon));}},_defineProperty(_class2,\"propTypes\",{attachment:ImmutablePropTypes.map.isRequired,displayWidth:PropTypes.number.isRequired,onOpenMedia:PropTypes.func.isRequired,autoPlayGif:PropTypes.bool,displayMedia:PropTypes.string}),_temp))||_class);export{MediaItem as default};","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";var _dec,_class,_class2,_temp;import\"core-js/modules/web.dom-collections.iterator.js\";import PropTypes from'prop-types';import React from'react';import ImmutablePropTypes from'react-immutable-proptypes';import ImmutablePureComponent from'react-immutable-pure-component';import{FormattedMessage}from'react-intl';import{connect}from'react-redux';import{NavLink}from'react-router-dom';import{fetchAccount,fetchAccountByUsername}from'soapbox/actions/accounts';import{openModal}from'soapbox/actions/modals';import Column from'soapbox/components/column';import LoadMore from'soapbox/components/load_more';import LoadingIndicator from'soapbox/components/loading_indicator';import MissingIndicator from'soapbox/components/missing_indicator';import SubNavigation from'soapbox/components/sub_navigation';import{getAccountGallery,findAccountByUsername}from'soapbox/selectors';import{getFeatures}from'soapbox/utils/features';import{expandAccountMediaTimeline}from'../../actions/timelines';import MediaItem from'./components/media_item';const mapStateToProps=(state,{params,withReplies=false})=>{const username=params.username||'';const me=state.get('me');const accountFetchError=(state.getIn(['accounts',-1,'username'])||'').toLowerCase()===username.toLowerCase();const features=getFeatures(state.get('instance'));let accountId=-1;let accountUsername=username;if(accountFetchError){accountId=null;}else{const account=findAccountByUsername(state,username);accountId=account?account.getIn(['id'],null):-1;accountUsername=account?account.getIn(['acct'],''):'';}const isBlocked=state.getIn(['relationships',accountId,'blocked_by'],false);const unavailable=me===accountId?false:isBlocked&&!features.blockersVisible;return{accountId,unavailable,accountUsername,isAccount:!!state.getIn(['accounts',accountId]),attachments:getAccountGallery(state,accountId),isLoading:state.getIn(['timelines',\"account:\".concat(accountId,\":media\"),'isLoading']),hasMore:state.getIn(['timelines',\"account:\".concat(accountId,\":media\"),'hasMore'])};};class LoadMoreMedia extends ImmutablePureComponent{constructor(...args){super(...args);_defineProperty(this,\"handleLoadMore\",()=>{this.props.onLoadMore(this.props.maxId);});}render(){return/*#__PURE__*/_jsx(LoadMore,{disabled:this.props.disabled,onClick:this.handleLoadMore});}}_defineProperty(LoadMoreMedia,\"propTypes\",{maxId:PropTypes.string,onLoadMore:PropTypes.func.isRequired});let AccountGallery=(_dec=connect(mapStateToProps),_dec(_class=(_temp=_class2=class AccountGallery extends ImmutablePureComponent{constructor(...args){super(...args);_defineProperty(this,\"state\",{width:323});_defineProperty(this,\"handleScrollToBottom\",()=>{if(this.props.hasMore){this.handleLoadMore(this.props.attachments.size>0?this.props.attachments.last().getIn(['status','id']):undefined);}});_defineProperty(this,\"handleScroll\",e=>{const{scrollTop,scrollHeight,clientHeight}=e.target;const offset=scrollHeight-scrollTop-clientHeight;if(150>offset&&!this.props.isLoading){this.handleScrollToBottom();}});_defineProperty(this,\"handleLoadMore\",maxId=>{if(this.props.accountId&&this.props.accountId!==-1){this.props.dispatch(expandAccountMediaTimeline(this.props.accountId,{maxId}));}});_defineProperty(this,\"handleLoadOlder\",e=>{e.preventDefault();this.handleScrollToBottom();});_defineProperty(this,\"handleOpenMedia\",attachment=>{if(attachment.get('type')==='video'){this.props.dispatch(openModal('VIDEO',{media:attachment,status:attachment.get('status'),account:attachment.get('account')}));}else{const media=attachment.getIn(['status','media_attachments']);const index=media.findIndex(x=>x.get('id')===attachment.get('id'));this.props.dispatch(openModal('MEDIA',{media,index,status:attachment.get('status'),account:attachment.get('account')}));}});_defineProperty(this,\"handleRef\",c=>{if(c){this.setState({width:c.offsetWidth});}});}componentDidMount(){const{params:{username},accountId}=this.props;if(accountId&&accountId!==-1){this.props.dispatch(fetchAccount(accountId));this.props.dispatch(expandAccountMediaTimeline(accountId));}else{this.props.dispatch(fetchAccountByUsername(username));}}componentDidUpdate(prevProps){const{accountId,params}=this.props;if(accountId&&accountId!==-1&&accountId!==prevProps.accountId&&accountId){this.props.dispatch(fetchAccount(params.accountId));this.props.dispatch(expandAccountMediaTimeline(accountId));}}render(){const{attachments,isLoading,hasMore,isAccount,accountId,unavailable,accountUsername}=this.props;const{width}=this.state;if(!isAccount&&accountId!==-1){return/*#__PURE__*/_jsx(Column,{},void 0,/*#__PURE__*/_jsx(MissingIndicator,{}));}if(accountId===-1||!attachments&&isLoading){return/*#__PURE__*/_jsx(Column,{},void 0,/*#__PURE__*/_jsx(LoadingIndicator,{}));}let loadOlder=null;if(hasMore&&!(isLoading&&attachments.size===0)){loadOlder=/*#__PURE__*/_jsx(LoadMore,{visible:!isLoading,onClick:this.handleLoadOlder});}if(unavailable){return/*#__PURE__*/_jsx(Column,{},void 0,/*#__PURE__*/_jsx(\"div\",{className:\"empty-column-indicator\"},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"empty_column.account_unavailable\",defaultMessage:\"Profile unavailable\"})));}return/*#__PURE__*/_jsx(Column,{},void 0,/*#__PURE__*/_jsx(SubNavigation,{message:\"@\".concat(accountUsername)}),/*#__PURE__*/_jsx(\"div\",{className:\"slist slist--flex\",onScroll:this.handleScroll},void 0,/*#__PURE__*/_jsx(\"div\",{className:\"account__section-headline\"},void 0,/*#__PURE__*/_jsx(\"div\",{style:{width:'100%',display:'flex'}},void 0,/*#__PURE__*/_jsx(NavLink,{exact:true,to:\"/@\".concat(accountUsername)},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"account.posts\",defaultMessage:\"Posts\"})),/*#__PURE__*/_jsx(NavLink,{exact:true,to:\"/@\".concat(accountUsername,\"/with_replies\")},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"account.posts_with_replies\",defaultMessage:\"Posts and replies\"})),/*#__PURE__*/_jsx(NavLink,{exact:true,to:\"/@\".concat(accountUsername,\"/media\")},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"account.media\",defaultMessage:\"Media\"})))),/*#__PURE__*/React.createElement(\"div\",{role:\"feed\",className:\"account-gallery__container\",ref:this.handleRef},attachments.map((attachment,index)=>attachment===null?/*#__PURE__*/_jsx(LoadMoreMedia,{maxId:index>0?attachments.getIn(index-1,'id'):null,onLoadMore:this.handleLoadMore},'more:'+attachments.getIn(index+1,'id')):/*#__PURE__*/_jsx(MediaItem,{attachment:attachment,displayWidth:width,onOpenMedia:this.handleOpenMedia},\"\".concat(attachment.getIn(['status','id']),\"+\").concat(attachment.get('id')))),attachments.size===0&&/*#__PURE__*/_jsx(\"div\",{className:\"empty-column-indicator\"},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"account_gallery.none\",defaultMessage:\"No media to show.\"})),loadOlder),isLoading&&attachments.size===0&&/*#__PURE__*/_jsx(\"div\",{className:\"slist__append\"},void 0,/*#__PURE__*/_jsx(LoadingIndicator,{}))));}},_defineProperty(_class2,\"propTypes\",{params:PropTypes.object.isRequired,dispatch:PropTypes.func.isRequired,attachments:ImmutablePropTypes.list.isRequired,isLoading:PropTypes.bool,hasMore:PropTypes.bool,isAccount:PropTypes.bool,unavailable:PropTypes.bool}),_temp))||_class);export{AccountGallery as default};","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";import\"core-js/modules/web.dom-collections.iterator.js\";import PropTypes from'prop-types';import React from'react';import ImmutablePropTypes from'react-immutable-proptypes';import ImmutablePureComponent from'react-immutable-pure-component';import{FormattedMessage,injectIntl}from'react-intl';import{connect}from'react-redux';import{openModal}from'soapbox/actions/modals';import Icon from'soapbox/components/icon';import LoadingIndicator from'soapbox/components/loading_indicator';import{getAccountGallery}from'soapbox/selectors';import{expandAccountMediaTimeline}from'../../../actions/timelines';import MediaItem from'../../account_gallery/components/media_item';class ProfileMediaPanel extends ImmutablePureComponent{constructor(...args){super(...args);_defineProperty(this,\"state\",{isLoading:true});_defineProperty(this,\"handleOpenMedia\",attachment=>{if(attachment.get('type')==='video'){this.props.dispatch(openModal('VIDEO',{media:attachment,status:attachment.get('status')}));}else{const media=attachment.getIn(['status','media_attachments']);const index=media.findIndex(x=>x.get('id')===attachment.get('id'));this.props.dispatch(openModal('MEDIA',{media,index,status:attachment.get('status'),account:attachment.get('account')}));}});_defineProperty(this,\"fetchMedia\",()=>{const{account}=this.props;if(account){const accountId=account.get('id');this.props.dispatch(expandAccountMediaTimeline(accountId)).then(()=>this.setState({isLoading:false})).catch(()=>{});}});}componentDidMount(){this.fetchMedia();}componentDidUpdate(prevProps){const oldId=prevProps.account&&prevProps.account.get('id');const newId=this.props.account&&this.props.account.get('id');if(newId!==oldId){this.setState({isLoading:true});this.fetchMedia();}}renderAttachments(){const{attachments}=this.props;const publicAttachments=attachments.filter(attachment=>attachment.getIn(['status','visibility'])==='public');const nineAttachments=publicAttachments.slice(0,9);if(!nineAttachments.isEmpty()){return/*#__PURE__*/_jsx(\"div\",{className:\"media-panel__list\"},void 0,nineAttachments.map((attachment,index)=>/*#__PURE__*/_jsx(MediaItem,{attachment:attachment,displayWidth:255,onOpenMedia:this.handleOpenMedia},\"\".concat(attachment.getIn(['status','id']),\"+\").concat(attachment.get('id')))));}else{return/*#__PURE__*/_jsx(\"div\",{className:\"media-panel__empty\"},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"media_panel.empty_message\",defaultMessage:\"No media found.\"}));}}render(){const{account}=this.props;const{isLoading}=this.state;return/*#__PURE__*/_jsx(\"div\",{className:\"media-panel\"},void 0,/*#__PURE__*/_jsx(\"div\",{className:\"media-panel-header\"},void 0,/*#__PURE__*/_jsx(Icon,{src:require('@tabler/icons/icons/camera.svg'),className:\"media-panel-header__icon\"}),/*#__PURE__*/_jsx(\"span\",{className:\"media-panel-header__label\"},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"media_panel.title\",defaultMessage:\"Media\"}))),account&&/*#__PURE__*/_jsx(\"div\",{className:\"media-panel__content\"},void 0,isLoading?/*#__PURE__*/_jsx(LoadingIndicator,{}):this.renderAttachments()));}}_defineProperty(ProfileMediaPanel,\"propTypes\",{account:ImmutablePropTypes.map,attachments:ImmutablePropTypes.list,dispatch:PropTypes.func.isRequired});const mapStateToProps=(state,{account})=>({attachments:getAccountGallery(state,account.get('id'))});export default injectIntl(connect(mapStateToProps,null,null,{forwardRef:true})(ProfileMediaPanel));"],"names":["_class","_class2","_temp","MediaItem","state","autoPlayGif","get","displayMedia","_dec","args","visible","props","attachment","getIn","loaded","setState","e","hoverToPlay","target","play","pause","currentTime","indexOf","button","ctrlKey","metaKey","preventDefault","onOpenMedia","render","icon","this","displayWidth","width","concat","Math","floor","height","status","title","thumbnail","x","y","src","alt","style","objectPosition","conditionalAttributes","playsInline","autoPlay","className","autoplay","role","onMouseEnter","handleMouseEnter","onMouseLeave","handleMouseLeave","loop","muted","remoteURL","fileExtensionLastIndex","lastIndexOf","fileExtension","substr","toUpperCase","id","href","onClick","handleClick","hash","onLoadMore","maxId","disabled","handleLoadMore","LoadMoreMedia","AccountGallery","params","username","withReplies","me","accountFetchError","toLowerCase","features","accountId","accountUsername","account","isBlocked","unavailable","blockersVisible","isAccount","attachments","isLoading","hasMore","size","last","undefined","scrollTop","handleScrollToBottom","dispatch","media","index","findIndex","c","offsetWidth","componentDidMount","componentDidUpdate","prevProps","loadOlder","handleLoadOlder","defaultMessage","message","onScroll","handleScroll","display","exact","to","ref","handleRef","map","handleOpenMedia","then","catch","fetchMedia","oldId","renderAttachments","nineAttachments","filter","slice","isEmpty","ProfileMediaPanel","forwardRef"],"sourceRoot":""}