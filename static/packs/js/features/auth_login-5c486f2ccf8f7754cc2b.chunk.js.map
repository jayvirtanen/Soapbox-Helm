{"version":3,"file":"packs/js/features/auth_login-5c486f2ccf8f7754cc2b.chunk.js","mappings":"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","sources":["webpack://soapbox-fe/./app/soapbox/features/auth_login/components/login_page.js","webpack://soapbox-fe/./app/soapbox/features/auth_login/components/password_reset.js"],"sourcesContent":["import _jsx from\"@babel/runtime/helpers/esm/jsx\";import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";var _dec,_class;import React from'react';import ImmutablePureComponent from'react-immutable-pure-component';import{injectIntl}from'react-intl';import{connect}from'react-redux';import{Redirect}from'react-router-dom';import{logIn,verifyCredentials,switchAccount}from'soapbox/actions/auth';import{fetchInstance}from'soapbox/actions/instance';import{isStandalone}from'soapbox/utils/state';import LoginForm from'./login_form';import OtpAuthForm from'./otp_auth_form';const mapStateToProps=state=>({me:state.get('me'),isLoading:false,standalone:isStandalone(state)});let LoginPage=(_dec=connect(mapStateToProps),_dec(_class=injectIntl(_class=class LoginPage extends ImmutablePureComponent{constructor(props){super(props);_defineProperty(this,\"state\",{isLoading:false,mfa_auth_needed:false,mfa_token:'',shouldRedirect:false});_defineProperty(this,\"getFormData\",form=>{return Object.fromEntries(Array.from(form).map(i=>[i.name,i.value]));});_defineProperty(this,\"handleSubmit\",event=>{const{dispatch,intl,me}=this.props;const{username,password}=this.getFormData(event.target);dispatch(logIn(intl,username,password)).then(({access_token})=>{return dispatch(verifyCredentials(access_token))// Refetch the instance for authenticated fetch\n.then(()=>dispatch(fetchInstance()));}).then(account=>{this.setState({shouldRedirect:true});if(typeof me==='string'){dispatch(switchAccount(account.id));}}).catch(error=>{var _error$response;const data=(_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.data;if((data===null||data===void 0?void 0:data.error)==='mfa_required'){this.setState({mfa_auth_needed:true,mfa_token:data.mfa_token});}this.setState({isLoading:false});});this.setState({isLoading:true});event.preventDefault();});this.handleSubmit=this.handleSubmit.bind(this);}render(){const{standalone}=this.props;const{isLoading,mfa_auth_needed,mfa_token,shouldRedirect}=this.state;if(standalone)return/*#__PURE__*/_jsx(Redirect,{to:\"/auth/external\"});if(shouldRedirect)return/*#__PURE__*/_jsx(Redirect,{to:\"/\"});if(mfa_auth_needed)return/*#__PURE__*/_jsx(OtpAuthForm,{mfa_token:mfa_token});return/*#__PURE__*/_jsx(LoginForm,{handleSubmit:this.handleSubmit,isLoading:isLoading});}})||_class)||_class);export{LoginPage as default};","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";var _dec,_class;import\"core-js/modules/web.dom-collections.iterator.js\";import React from'react';import ImmutablePureComponent from'react-immutable-pure-component';import{defineMessages,FormattedMessage,injectIntl}from'react-intl';import{connect}from'react-redux';import{Redirect}from'react-router-dom';import{resetPassword}from'soapbox/actions/security';import snackbar from'soapbox/actions/snackbar';import{SimpleForm,FieldsGroup,TextInput}from'soapbox/features/forms';const messages=defineMessages({nicknameOrEmail:{\"id\":\"password_reset.fields.username_placeholder\",\"defaultMessage\":\"Email or username\"},confirmation:{\"id\":\"password_reset.confirmation\",\"defaultMessage\":\"Check your email for confirmation.\"}});let PasswordReset=(_dec=connect(),_dec(_class=injectIntl(_class=class PasswordReset extends ImmutablePureComponent{constructor(...args){super(...args);_defineProperty(this,\"state\",{isLoading:false,success:false});_defineProperty(this,\"handleSubmit\",e=>{const{dispatch,intl}=this.props;const nicknameOrEmail=e.target.nickname_or_email.value;this.setState({isLoading:true});dispatch(resetPassword(nicknameOrEmail)).then(()=>{this.setState({isLoading:false,success:true});dispatch(snackbar.info(intl.formatMessage(messages.confirmation)));}).catch(error=>{this.setState({isLoading:false});});});}render(){const{intl}=this.props;if(this.state.success)return/*#__PURE__*/_jsx(Redirect,{to:\"/\"});return/*#__PURE__*/_jsx(SimpleForm,{onSubmit:this.handleSubmit},void 0,/*#__PURE__*/_jsx(\"fieldset\",{disabled:this.state.isLoading},void 0,/*#__PURE__*/_jsx(FieldsGroup,{},void 0,/*#__PURE__*/_jsx(TextInput,{name:\"nickname_or_email\",label:intl.formatMessage(messages.nicknameOrEmail),placeholder:\"me@example.com\",required:true}))),/*#__PURE__*/_jsx(\"div\",{className:\"actions\"},void 0,/*#__PURE__*/_jsx(\"button\",{name:\"button\",type:\"submit\",className:\"btn button button-primary\"},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"password_reset.reset\",defaultMessage:\"Reset password\"}))));}})||_class)||_class);export{PasswordReset as default};"],"names":["_class","LoginPage","state","me","get","isLoading","standalone","_dec","props","mfa_auth_needed","mfa_token","shouldRedirect","form","Object","fromEntries","Array","from","map","i","name","value","event","dispatch","intl","getFormData","target","username","password","then","access_token","account","setState","id","catch","error","_error$response","data","response","preventDefault","handleSubmit","bind","render","this","to","messages","nicknameOrEmail","confirmation","PasswordReset","args","success","e","nickname_or_email","formatMessage","onSubmit","disabled","label","placeholder","required","className","type","defaultMessage"],"sourceRoot":""}