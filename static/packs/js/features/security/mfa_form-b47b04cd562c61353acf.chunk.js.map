{"version":3,"file":"packs/js/features/security/mfa_form-b47b04cd562c61353acf.chunk.js","mappings":"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","sources":["webpack://soapbox-fe/./app/soapbox/features/security/mfa_form.js"],"sourcesContent":["import _jsx from\"@babel/runtime/helpers/esm/jsx\";import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";var _dec,_class,_class2,_temp,_dec2,_class3,_class4,_temp2,_dec3,_class5,_class6,_temp3,_dec4,_class7,_class8,_temp4;import\"core-js/modules/web.dom-collections.iterator.js\";import PropTypes from'prop-types';import QRCode from'qrcode.react';import React from'react';import ImmutablePropTypes from'react-immutable-proptypes';import ImmutablePureComponent from'react-immutable-pure-component';import{defineMessages,injectIntl,FormattedMessage}from'react-intl';import{connect}from'react-redux';import{withRouter}from'react-router-dom';import snackbar from'soapbox/actions/snackbar';import Button from'soapbox/components/button';import LoadingIndicator from'soapbox/components/loading_indicator';import ShowablePassword from'soapbox/components/showable_password';import{SimpleForm,FieldsGroup,TextInput}from'soapbox/features/forms';import{fetchMfa,fetchBackupCodes,setupMfa,confirmMfa,disableMfa}from'../../actions/mfa';import Column from'../ui/components/column';import ColumnSubheading from'../ui/components/column_subheading';/*\nSecurity settings page for user account\nRouted to /auth/mfa\nIncludes following features:\n- Set up Multi-factor Auth\n*/const messages=defineMessages({heading:{\"id\":\"column.security\",\"defaultMessage\":\"Security\"},subheading:{\"id\":\"column.mfa\",\"defaultMessage\":\"Multi-Factor Authentication\"},mfa_cancel_button:{\"id\":\"column.mfa_cancel\",\"defaultMessage\":\"Cancel\"},mfa_setup_button:{\"id\":\"column.mfa_setup\",\"defaultMessage\":\"Proceed to Setup\"},mfa_setup_confirm_button:{\"id\":\"column.mfa_confirm_button\",\"defaultMessage\":\"Confirm\"},mfa_setup_disable_button:{\"id\":\"column.mfa_disable_button\",\"defaultMessage\":\"Disable\"},passwordFieldLabel:{\"id\":\"security.fields.password.label\",\"defaultMessage\":\"Password\"},confirmFail:{\"id\":\"security.confirm.fail\",\"defaultMessage\":\"Incorrect code or password. Try again.\"},qrFail:{\"id\":\"security.qr.fail\",\"defaultMessage\":\"Failed to fetch setup key\"},codesFail:{\"id\":\"security.codes.fail\",\"defaultMessage\":\"Failed to fetch backup codes\"},disableFail:{\"id\":\"security.disable.fail\",\"defaultMessage\":\"Incorrect password. Try again.\"},mfaDisableSuccess:{\"id\":\"mfa.disable.success_message\",\"defaultMessage\":\"MFA disabled\"},mfaConfirmSuccess:{\"id\":\"mfa.confirm.success_message\",\"defaultMessage\":\"MFA confirmed\"},codePlaceholder:{\"id\":\"mfa.mfa_setup.code_placeholder\",\"defaultMessage\":\"Code\"},passwordPlaceholder:{\"id\":\"mfa.mfa_setup.password_placeholder\",\"defaultMessage\":\"Password\"}});const mapStateToProps=state=>({backup_codes:state.getIn(['auth','backup_codes','codes']),mfa:state.getIn(['security','mfa'])});let MfaForm=(_dec4=connect(mapStateToProps),_dec4(_class7=injectIntl(_class7=withRouter(_class7=(_temp4=_class8=class MfaForm extends ImmutablePureComponent{constructor(...args){super(...args);_defineProperty(this,\"state\",{displayOtpForm:false});_defineProperty(this,\"handleSetupProceedClick\",e=>{this.setState({displayOtpForm:true});e.preventDefault();});}componentDidMount(){this.props.dispatch(fetchMfa());}render(){const{intl,mfa}=this.props;const{displayOtpForm}=this.state;return/*#__PURE__*/_jsx(Column,{icon:\"lock\",heading:intl.formatMessage(messages.heading)},void 0,/*#__PURE__*/_jsx(ColumnSubheading,{text:intl.formatMessage(messages.subheading)}),mfa.getIn(['settings','totp'])?/*#__PURE__*/_jsx(DisableOtpForm,{}):/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/_jsx(EnableOtpForm,{handleSetupProceedClick:this.handleSetupProceedClick}),displayOtpForm&&/*#__PURE__*/_jsx(OtpConfirmForm,{})));}},_defineProperty(_class8,\"propTypes\",{intl:PropTypes.object.isRequired,dispatch:PropTypes.func.isRequired,mfa:ImmutablePropTypes.map.isRequired,history:PropTypes.object}),_temp4))||_class7)||_class7)||_class7);export{MfaForm as default};let DisableOtpForm=(_dec=connect(),_dec(_class=injectIntl(_class=withRouter(_class=(_temp=_class2=class DisableOtpForm extends ImmutablePureComponent{constructor(...args){super(...args);_defineProperty(this,\"state\",{password:'',isLoading:false});_defineProperty(this,\"handleInputChange\",e=>{this.setState({[e.target.name]:e.target.value});});_defineProperty(this,\"handleSubmit\",e=>{const{password}=this.state;const{dispatch,intl}=this.props;this.setState({isLoading:true});dispatch(disableMfa('totp',password)).then(()=>{dispatch(snackbar.success(intl.formatMessage(messages.mfaDisableSuccess)));this.props.history.push('../auth/edit');}).catch(error=>{dispatch(snackbar.error(intl.formatMessage(messages.disableFail)));this.setState({isLoading:false});});e.preventDefault();});}render(){const{intl}=this.props;const{isLoading,password}=this.state;return/*#__PURE__*/_jsx(\"div\",{className:\"security-settings-panel\"},void 0,/*#__PURE__*/_jsx(SimpleForm,{onSubmit:this.handleSubmit,disabled:isLoading},void 0,/*#__PURE__*/_jsx(\"h1\",{className:\"security-settings-panel__setup-otp\"},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"mfa.otp_enabled_title\",defaultMessage:\"OTP Enabled\"})),/*#__PURE__*/_jsx(\"h2\",{className:\"security-settings-panel__setup-otp\"},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"mfa.otp_enabled_description\",defaultMessage:\"You have enabled two-factor authentication via OTP.\"})),/*#__PURE__*/_jsx(ShowablePassword,{label:intl.formatMessage(messages.passwordPlaceholder),placeholder:intl.formatMessage(messages.passwordPlaceholder),hint:/*#__PURE__*/_jsx(FormattedMessage,{id:\"mfa.mfa_disable_enter_password\",defaultMessage:\"Enter your current password to disable two-factor auth.\"}),disabled:isLoading,name:\"password\",onChange:this.handleInputChange,value:password,required:true}),/*#__PURE__*/_jsx(\"div\",{className:\"security-settings-panel__setup-otp__buttons\"},void 0,/*#__PURE__*/_jsx(Button,{disabled:isLoading,className:\"button button-primary disable\",text:intl.formatMessage(messages.mfa_setup_disable_button)}))));}},_defineProperty(_class2,\"propTypes\",{intl:PropTypes.object.isRequired,dispatch:PropTypes.func.isRequired,history:PropTypes.object}),_temp))||_class)||_class)||_class);let EnableOtpForm=(_dec2=connect(),_dec2(_class3=injectIntl(_class3=withRouter(_class3=(_temp2=_class4=class EnableOtpForm extends ImmutablePureComponent{constructor(...args){super(...args);_defineProperty(this,\"state\",{backupCodes:[]});_defineProperty(this,\"handleCancelClick\",e=>{this.props.history.push('../auth/edit');e.preventDefault();});}componentDidMount(){const{dispatch,intl}=this.props;dispatch(fetchBackupCodes()).then(({codes:backupCodes})=>{this.setState({backupCodes});}).catch(error=>{dispatch(snackbar.error(intl.formatMessage(messages.codesFail)));});}render(){const{intl}=this.props;const{backupCodes,displayOtpForm}=this.state;return/*#__PURE__*/_jsx(\"div\",{className:\"security-settings-panel\"},void 0,/*#__PURE__*/_jsx(SimpleForm,{},void 0,/*#__PURE__*/_jsx(\"h1\",{className:\"security-settings-panel__setup-otp\"},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"mfa.setup_otp_title\",defaultMessage:\"OTP Disabled\"})),/*#__PURE__*/_jsx(\"h2\",{className:\"security-settings-panel__setup-otp\"},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"mfa.setup_hint\",defaultMessage:\"Follow these steps to set up multi-factor authentication on your account with OTP\"})),/*#__PURE__*/_jsx(\"div\",{className:\"security-warning\"},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"mfa.setup_warning\",defaultMessage:\"Write these codes down or save them somewhere secure - otherwise you won't see them again. If you lose access to your 2FA app and recovery codes you'll be locked out of your account.\"})),/*#__PURE__*/_jsx(\"h2\",{className:\"security-settings-panel__setup-otp\"},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"mfa.setup_recoverycodes\",defaultMessage:\"Recovery codes\"})),/*#__PURE__*/_jsx(\"div\",{className:\"backup_codes\"},void 0,backupCodes.length>0?/*#__PURE__*/_jsx(\"div\",{},void 0,backupCodes.map((code,i)=>/*#__PURE__*/_jsx(\"div\",{className:\"backup_code\"},i,/*#__PURE__*/_jsx(\"div\",{className:\"backup_code\"},void 0,code)))):/*#__PURE__*/_jsx(LoadingIndicator,{})),!displayOtpForm&&/*#__PURE__*/_jsx(\"div\",{className:\"security-settings-panel__setup-otp__buttons\"},void 0,/*#__PURE__*/_jsx(Button,{className:\"button button-secondary cancel\",text:intl.formatMessage(messages.mfa_cancel_button),onClick:this.handleCancelClick}),backupCodes.length>0&&/*#__PURE__*/_jsx(Button,{className:\"button button-primary setup\",text:intl.formatMessage(messages.mfa_setup_button),onClick:this.props.handleSetupProceedClick}))));}},_defineProperty(_class4,\"propTypes\",{intl:PropTypes.object.isRequired,dispatch:PropTypes.func.isRequired,history:PropTypes.object}),_temp2))||_class3)||_class3)||_class3);let OtpConfirmForm=(_dec3=connect(),_dec3(_class5=injectIntl(_class5=withRouter(_class5=(_temp3=_class6=class OtpConfirmForm extends ImmutablePureComponent{constructor(...args){super(...args);_defineProperty(this,\"state\",{password:'',isLoading:false,code:'',qrCodeURI:'',confirm_key:''});_defineProperty(this,\"handleInputChange\",e=>{this.setState({[e.target.name]:e.target.value});});_defineProperty(this,\"handleCancelClick\",e=>{this.props.history.push('../auth/edit');e.preventDefault();});_defineProperty(this,\"handleSubmit\",e=>{const{dispatch,intl}=this.props;const{code,password}=this.state;this.setState({isLoading:true});dispatch(confirmMfa('totp',code,password)).then(()=>{dispatch(snackbar.success(intl.formatMessage(messages.mfaConfirmSuccess)));this.props.history.push('../auth/edit');}).catch(error=>{dispatch(snackbar.error(intl.formatMessage(messages.confirmFail)));this.setState({isLoading:false});});e.preventDefault();});}componentDidMount(){const{dispatch,intl}=this.props;dispatch(setupMfa('totp')).then(data=>{this.setState({qrCodeURI:data.provisioning_uri,confirm_key:data.key});}).catch(error=>{dispatch(snackbar.error(intl.formatMessage(messages.qrFail)));});}render(){const{intl}=this.props;const{isLoading,qrCodeURI,confirm_key,password,code}=this.state;return/*#__PURE__*/_jsx(\"div\",{className:\"security-settings-panel\"},void 0,/*#__PURE__*/_jsx(SimpleForm,{onSubmit:this.handleSubmit,disabled:isLoading},void 0,/*#__PURE__*/_jsx(\"fieldset\",{disabled:false},void 0,/*#__PURE__*/_jsx(FieldsGroup,{},void 0,/*#__PURE__*/_jsx(\"div\",{className:\"security-settings-panel__section-container\"},void 0,/*#__PURE__*/_jsx(\"h2\",{},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"mfa.mfa_setup_scan_title\",defaultMessage:\"Scan\"})),/*#__PURE__*/_jsx(\"div\",{},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"mfa.mfa_setup_scan_description\",defaultMessage:\"Using your two-factor app, scan this QR code or enter the text key.\"})),/*#__PURE__*/_jsx(\"div\",{className:\"security-settings-panel__qr-code\"},void 0,/*#__PURE__*/_jsx(QRCode,{value:qrCodeURI}),/*#__PURE__*/_jsx(\"div\",{className:\"security-settings-panel__confirm-key\"},void 0,confirm_key))),/*#__PURE__*/_jsx(\"div\",{className:\"security-settings-panel__section-container\"},void 0,/*#__PURE__*/_jsx(\"h2\",{},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"mfa.mfa_setup_verify_title\",defaultMessage:\"Verify\"})),/*#__PURE__*/_jsx(TextInput,{name:\"code\",label:intl.formatMessage(messages.codePlaceholder),hint:/*#__PURE__*/_jsx(FormattedMessage,{id:\"mfa.mfa_setup.code_hint\",defaultMessage:\"Enter the code from your two-factor app.\"}),placeholder:intl.formatMessage(messages.codePlaceholder),onChange:this.handleInputChange,autoComplete:\"off\",value:code,disabled:isLoading,required:true}),/*#__PURE__*/_jsx(ShowablePassword,{name:\"password\",label:intl.formatMessage(messages.passwordPlaceholder),hint:/*#__PURE__*/_jsx(FormattedMessage,{id:\"mfa.mfa_setup.password_hint\",defaultMessage:\"Enter your current password to confirm your identity.\"}),placeholder:intl.formatMessage(messages.passwordPlaceholder),onChange:this.handleInputChange,value:password,disabled:isLoading,required:true})))),/*#__PURE__*/_jsx(\"div\",{className:\"security-settings-panel__setup-otp__buttons\"},void 0,/*#__PURE__*/_jsx(Button,{type:\"button\",className:\"button button-secondary cancel\",text:intl.formatMessage(messages.mfa_cancel_button),onClick:this.handleCancelClick,disabled:isLoading}),/*#__PURE__*/_jsx(Button,{type:\"submit\",className:\"button button-primary setup\",text:intl.formatMessage(messages.mfa_setup_confirm_button),disabled:isLoading}))));}},_defineProperty(_class6,\"propTypes\",{intl:PropTypes.object.isRequired,history:PropTypes.object}),_temp3))||_class5)||_class5)||_class5);"],"names":["_class","_class2","_temp","_class3","_class4","_temp2","_class5","_class6","_temp3","_class7","_class8","_temp4","messages","heading","subheading","mfa_cancel_button","mfa_setup_button","mfa_setup_confirm_button","mfa_setup_disable_button","passwordFieldLabel","confirmFail","qrFail","codesFail","disableFail","mfaDisableSuccess","mfaConfirmSuccess","codePlaceholder","passwordPlaceholder","MfaForm","state","backup_codes","getIn","mfa","_dec4","args","displayOtpForm","e","setState","preventDefault","componentDidMount","this","props","dispatch","render","intl","icon","formatMessage","text","DisableOtpForm","EnableOtpForm","handleSetupProceedClick","OtpConfirmForm","history","_dec","password","isLoading","target","name","value","then","push","catch","error","className","onSubmit","handleSubmit","disabled","id","defaultMessage","label","placeholder","hint","onChange","handleInputChange","required","_dec2","backupCodes","length","map","code","i","onClick","handleCancelClick","_dec3","qrCodeURI","confirm_key","data","provisioning_uri","key","autoComplete","type"],"sourceRoot":""}