{"version":3,"file":"packs/js/features/conversations-02d7aa630ab4f5270401.chunk.js","mappings":"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","sources":["webpack://soapbox-fe/./app/soapbox/features/conversations/components/conversation.js","webpack://soapbox-fe/./app/soapbox/features/conversations/containers/conversation_container.js","webpack://soapbox-fe/./app/soapbox/features/conversations/components/conversations_list.js","webpack://soapbox-fe/./app/soapbox/features/conversations/containers/conversations_list_container.js","webpack://soapbox-fe/./app/soapbox/features/conversations/index.js"],"sourcesContent":["import _jsx from\"@babel/runtime/helpers/esm/jsx\";import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";var _class,_class2,_temp;import\"core-js/modules/web.dom-collections.iterator.js\";import PropTypes from'prop-types';import React from'react';import ImmutablePropTypes from'react-immutable-proptypes';import ImmutablePureComponent from'react-immutable-pure-component';import{withRouter}from'react-router-dom';import StatusContainer from'../../../containers/status_container';let Conversation=withRouter(_class=(_temp=_class2=class Conversation extends ImmutablePureComponent{constructor(...args){super(...args);_defineProperty(this,\"handleClick\",()=>{if(!this.props.history){return;}const{lastStatusId,unread,markRead}=this.props;if(unread){markRead();}this.props.history.push(\"/statuses/\".concat(lastStatusId));});_defineProperty(this,\"handleHotkeyMoveUp\",()=>{this.props.onMoveUp(this.props.conversationId);});_defineProperty(this,\"handleHotkeyMoveDown\",()=>{this.props.onMoveDown(this.props.conversationId);});}render(){const{accounts,lastStatusId,unread}=this.props;if(lastStatusId===null){return null;}return/*#__PURE__*/_jsx(StatusContainer,{id:lastStatusId,unread:unread,otherAccounts:accounts,onMoveUp:this.handleHotkeyMoveUp,onMoveDown:this.handleHotkeyMoveDown,onClick:this.handleClick});}},_defineProperty(_class2,\"propTypes\",{conversationId:PropTypes.string.isRequired,accounts:ImmutablePropTypes.list.isRequired,lastStatusId:PropTypes.string,unread:PropTypes.bool.isRequired,onMoveUp:PropTypes.func,onMoveDown:PropTypes.func,markRead:PropTypes.func.isRequired,history:PropTypes.object}),_temp))||_class;export{Conversation as default};","import{connect}from'react-redux';import{markConversationRead}from'../../../actions/conversations';import Conversation from'../components/conversation';const mapStateToProps=(state,{conversationId})=>{const conversation=state.getIn(['conversations','items']).find(x=>x.get('id')===conversationId);return{accounts:conversation.get('accounts').map(accountId=>state.getIn(['accounts',accountId],null)),unread:conversation.get('unread'),lastStatusId:conversation.get('last_status',null)};};const mapDispatchToProps=(dispatch,{conversationId})=>({markRead:()=>dispatch(markConversationRead(conversationId))});export default connect(mapStateToProps,mapDispatchToProps)(Conversation);","import _extends from\"@babel/runtime/helpers/esm/extends\";import _jsx from\"@babel/runtime/helpers/esm/jsx\";import _objectWithoutProperties from\"@babel/runtime/helpers/esm/objectWithoutProperties\";import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";import _debounce from\"lodash/debounce\";const _excluded=[\"conversations\",\"isLoading\",\"onLoadMore\"];import\"core-js/modules/web.dom-collections.iterator.js\";import PropTypes from'prop-types';import React from'react';import ImmutablePropTypes from'react-immutable-proptypes';import ImmutablePureComponent from'react-immutable-pure-component';import ScrollableList from'../../../components/scrollable_list';import ConversationContainer from'../containers/conversation_container';export default class ConversationsList extends ImmutablePureComponent{constructor(...args){super(...args);_defineProperty(this,\"getCurrentIndex\",id=>this.props.conversations.findIndex(x=>x.get('id')===id));_defineProperty(this,\"handleMoveUp\",id=>{const elementIndex=this.getCurrentIndex(id)-1;this._selectChild(elementIndex,true);});_defineProperty(this,\"handleMoveDown\",id=>{const elementIndex=this.getCurrentIndex(id)+1;this._selectChild(elementIndex,false);});_defineProperty(this,\"setRef\",c=>{this.node=c;});_defineProperty(this,\"handleLoadOlder\",_debounce(()=>{const maxId=this.props.conversations.getIn([-1,'id']);if(maxId)this.props.onLoadMore(maxId);},300,{leading:true}));}_selectChild(index,align_top){const container=this.node.node;const element=container.querySelector(\"article:nth-of-type(\".concat(index+1,\") .focusable\"));if(element){if(align_top&&container.scrollTop>element.offsetTop){element.scrollIntoView(true);}else if(!align_top&&container.scrollTop+container.clientHeight<element.offsetTop+element.offsetHeight){element.scrollIntoView(false);}element.focus();}}render(){const _this$props=this.props,{conversations,isLoading,onLoadMore}=_this$props,other=_objectWithoutProperties(_this$props,_excluded);return/*#__PURE__*/React.createElement(ScrollableList,_extends({},other,{onLoadMore:onLoadMore&&this.handleLoadOlder,scrollKey:\"direct\",ref:this.setRef,isLoading:isLoading,showLoading:isLoading&&conversations.size===0}),conversations.map(item=>/*#__PURE__*/_jsx(ConversationContainer,{conversationId:item.get('id'),onMoveUp:this.handleMoveUp,onMoveDown:this.handleMoveDown},item.get('id'))));}}_defineProperty(ConversationsList,\"propTypes\",{conversations:ImmutablePropTypes.list.isRequired,hasMore:PropTypes.bool,isLoading:PropTypes.bool,onLoadMore:PropTypes.func});","import{connect}from'react-redux';import{expandConversations}from'../../../actions/conversations';import ConversationsList from'../components/conversations_list';const mapStateToProps=state=>({conversations:state.getIn(['conversations','items']),isLoading:state.getIn(['conversations','isLoading'],true),hasMore:state.getIn(['conversations','hasMore'],false)});const mapDispatchToProps=dispatch=>({onLoadMore:maxId=>dispatch(expandConversations({maxId}))});export default connect(mapStateToProps,mapDispatchToProps)(ConversationsList);","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";var _dec,_class;import\"core-js/modules/web.dom-collections.iterator.js\";import React from'react';import{defineMessages,injectIntl,FormattedMessage}from'react-intl';import{connect}from'react-redux';import{directComposeById}from'soapbox/actions/compose';import AccountSearch from'soapbox/components/account_search';import{mountConversations,unmountConversations,expandConversations}from'../../actions/conversations';import{connectDirectStream}from'../../actions/streaming';import Column from'../../components/column';import ColumnHeader from'../../components/column_header';import ConversationsListContainer from'./containers/conversations_list_container';const messages=defineMessages({title:{\"id\":\"column.direct\",\"defaultMessage\":\"Direct messages\"},searchPlaceholder:{\"id\":\"direct.search_placeholder\",\"defaultMessage\":\"Send a message to\\u2026\"}});let ConversationsTimeline=(_dec=connect(),_dec(_class=injectIntl(_class=class ConversationsTimeline extends React.PureComponent{constructor(...args){super(...args);_defineProperty(this,\"handleSuggestion\",accountId=>{this.props.dispatch(directComposeById(accountId));});_defineProperty(this,\"handleLoadMore\",maxId=>{this.props.dispatch(expandConversations({maxId}));});}componentDidMount(){const{dispatch}=this.props;dispatch(mountConversations());dispatch(expandConversations());this.disconnect=dispatch(connectDirectStream());}componentWillUnmount(){this.props.dispatch(unmountConversations());if(this.disconnect){this.disconnect();this.disconnect=null;}}render(){const{intl,hasUnread}=this.props;return/*#__PURE__*/_jsx(Column,{label:intl.formatMessage(messages.title)},void 0,/*#__PURE__*/_jsx(ColumnHeader,{icon:\"envelope\",active:hasUnread,title:intl.formatMessage(messages.title)}),/*#__PURE__*/_jsx(AccountSearch,{placeholder:intl.formatMessage(messages.searchPlaceholder),onSelected:this.handleSuggestion}),/*#__PURE__*/_jsx(ConversationsListContainer,{scrollKey:\"direct_timeline\",timelineId:\"direct\",onLoadMore:this.handleLoadMore,emptyMessage:/*#__PURE__*/_jsx(FormattedMessage,{id:\"empty_column.direct\",defaultMessage:\"You don't have any direct messages yet. When you send or receive one, it will show up here.\"})}));}})||_class)||_class);export{ConversationsTimeline as default};"],"names":["_class","_class2","_temp","Conversation","args","props","history","lastStatusId","unread","markRead","push","concat","onMoveUp","conversationId","onMoveDown","render","this","accounts","id","otherAccounts","handleHotkeyMoveUp","handleHotkeyMoveDown","onClick","handleClick","state","conversation","getIn","find","x","get","map","accountId","dispatch","_excluded","conversations","findIndex","elementIndex","getCurrentIndex","_selectChild","c","node","maxId","onLoadMore","leading","index","align_top","container","element","querySelector","scrollTop","offsetTop","scrollIntoView","clientHeight","offsetHeight","focus","_this$props","isLoading","other","handleLoadOlder","scrollKey","ref","setRef","showLoading","size","item","handleMoveUp","handleMoveDown","ConversationsList","hasMore","messages","title","searchPlaceholder","ConversationsTimeline","_dec","injectIntl","componentDidMount","disconnect","componentWillUnmount","intl","hasUnread","label","formatMessage","icon","active","placeholder","onSelected","handleSuggestion","timelineId","handleLoadMore","emptyMessage","defaultMessage"],"sourceRoot":""}