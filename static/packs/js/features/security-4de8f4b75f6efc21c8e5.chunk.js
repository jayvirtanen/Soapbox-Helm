"use strict";(self.webpackChunksoapbox_fe=self.webpackChunksoapbox_fe||[]).push([[62],{1199:function(e,t,a){a.r(t),a.d(t,{default:function(){return Y}});var s,i,n,o,r,d,u,l,c,p,f,h,m,g,v,Z,b,y,w,M=a(1019),_=a(1018),P=(a(1),a(3)),S=a.n(P),k=a(5),C=a.n(k),N=a(4),L=a(1797),F=a(1017),A=a(2),j=a(1794),R=a(198),q=a(9),H=a(30),I=a(35),T=a(223),x=a(28),E=a(395),D=a(16),O=(s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])},s(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function a(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}),$=(0,L.vU)({heading:{id:"column.security",defaultMessage:"Security"},submit:{id:"security.submit",defaultMessage:"Save changes"},updateEmailSuccess:{id:"security.update_email.success",defaultMessage:"Email successfully updated."},updateEmailFail:{id:"security.update_email.fail",defaultMessage:"Update email failed."},updatePasswordSuccess:{id:"security.update_password.success",defaultMessage:"Password successfully updated."},updatePasswordFail:{id:"security.update_password.fail",defaultMessage:"Update password failed."},emailFieldLabel:{id:"security.fields.email.label",defaultMessage:"Email address"},passwordFieldLabel:{id:"security.fields.password.label",defaultMessage:"Password"},oldPasswordFieldLabel:{id:"security.fields.old_password.label",defaultMessage:"Current password"},newPasswordFieldLabel:{id:"security.fields.new_password.label",defaultMessage:"New password"},confirmationFieldLabel:{id:"security.fields.password_confirmation.label",defaultMessage:"New password (again)"},revoke:{id:"security.tokens.revoke",defaultMessage:"Revoke"},emailHeader:{id:"security.headers.update_email",defaultMessage:"Change Email"},passwordHeader:{id:"security.headers.update_password",defaultMessage:"Change Password"},tokenHeader:{id:"security.headers.tokens",defaultMessage:"Sessions"},deleteHeader:{id:"security.headers.delete",defaultMessage:"Delete Account"},deleteText:{id:"security.text.delete",defaultMessage:"To delete your account, enter your password then click Delete Account. This is a permanent action that cannot be undone. Your account will be destroyed from this server, and a deletion request will be sent to other servers. It's not guaranteed that all servers will purge your account."},deleteSubmit:{id:"security.submit.delete",defaultMessage:"Delete Account"},deleteAccountSuccess:{id:"security.delete_account.success",defaultMessage:"Account successfully deleted."},deleteAccountFail:{id:"security.delete_account.fail",defaultMessage:"Account deletion failed."},mfa:{id:"security.mfa",defaultMessage:"Set up 2-Factor Auth"},mfa_setup_hint:{id:"security.mfa_setup_hint",defaultMessage:"Configure multi-factor authentication with OTP"},mfa_enabled:{id:"security.mfa_enabled",defaultMessage:"You have multi-factor authentication set up with OTP."},disable_mfa:{id:"security.disable_mfa",defaultMessage:"Disable"},mfaHeader:{id:"security.mfa_header",defaultMessage:"Authorization Methods"}}),U=function(e){return{settings:(0,q.Gw)(e),tokens:e.getIn(["security","tokens"]),mfa:e.getIn(["security","mfa"])}},Y=(0,A.$j)(U)(b=(0,F.ZP)((w=y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return O(t,e),t.prototype.render=function(){var e=this.props.intl;return(0,M.Z)(D.Z,{icon:"lock",heading:e.formatMessage($.heading)},void 0,(0,M.Z)(z,{}),(0,M.Z)(G,{}),(0,M.Z)(J,{}),(0,M.Z)(B,{}),(0,M.Z)(K,{}))},t}(N.ZP),(0,_.Z)(y,"propTypes",{dispatch:S().func.isRequired,intl:S().object.isRequired}),b=w))||b)||b,z=(0,A.$j)()(i=(0,F.ZP)((o=n=function(e){function t(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];var s=e.apply(this,t)||this;return(0,_.Z)(s,"state",{email:"",password:"",isLoading:!1}),(0,_.Z)(s,"handleInputChange",(function(e){var t;s.setState(((t={})[e.target.name]=e.target.value,t))})),(0,_.Z)(s,"handleSubmit",(function(e){var t=s.state,a=t.email,i=t.password,n=s.props,o=n.dispatch,r=n.intl;return s.setState({isLoading:!0}),o((0,R.Uk)(a,i)).then((function(){s.setState({email:"",password:""}),o(H.ZP.success(r.formatMessage($.updateEmailSuccess)))})).catch((function(e){s.setState({password:""}),o(H.ZP.error(r.formatMessage($.updateEmailFail)))})).then((function(){s.setState({isLoading:!1})}))})),s}return O(t,e),t.prototype.render=function(){var e=this.props.intl;return(0,M.Z)(x.NA,{onSubmit:this.handleSubmit},void 0,(0,M.Z)("h2",{},void 0,e.formatMessage($.emailHeader)),(0,M.Z)("fieldset",{disabled:this.state.isLoading},void 0,(0,M.Z)(x.H_,{},void 0,(0,M.Z)(x.oi,{label:e.formatMessage($.emailFieldLabel),placeholder:"me@example.com",name:"email",onChange:this.handleInputChange,value:this.state.email}),(0,M.Z)(T.Z,{label:e.formatMessage($.passwordFieldLabel),name:"password",onChange:this.handleInputChange,value:this.state.password}),(0,M.Z)("div",{className:"actions"},void 0,(0,M.Z)("button",{name:"button",type:"submit",className:"btn button button-primary"},void 0,e.formatMessage($.submit))))))},t}(N.ZP),(0,_.Z)(n,"propTypes",{email:S().string,dispatch:S().func.isRequired,intl:S().object.isRequired}),i=o))||i)||i,G=(0,A.$j)()(r=(0,F.ZP)((u=d=function(e){function t(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];var s=e.apply(this,t)||this;return(0,_.Z)(s,"state",{oldPassword:"",newPassword:"",confirmation:"",isLoading:!1}),(0,_.Z)(s,"handleInputChange",(function(e){var t;s.setState(((t={})[e.target.name]=e.target.value,t))})),(0,_.Z)(s,"clearForm",(function(){s.setState({oldPassword:"",newPassword:"",confirmation:""})})),(0,_.Z)(s,"handleSubmit",(function(e){var t=s.state,a=t.oldPassword,i=t.newPassword,n=t.confirmation,o=s.props,r=o.dispatch,d=o.intl;return s.setState({isLoading:!0}),r((0,R.Cp)(a,i,n)).then((function(){s.clearForm(),r(H.ZP.success(d.formatMessage($.updatePasswordSuccess)))})).catch((function(e){s.clearForm(),r(H.ZP.error(d.formatMessage($.updatePasswordFail)))})).then((function(){s.setState({isLoading:!1})}))})),s}return O(t,e),t.prototype.render=function(){var e=this.props.intl;return(0,M.Z)(x.NA,{onSubmit:this.handleSubmit},void 0,(0,M.Z)("h2",{},void 0,e.formatMessage($.passwordHeader)),(0,M.Z)("fieldset",{disabled:this.state.isLoading},void 0,(0,M.Z)(x.H_,{},void 0,(0,M.Z)(T.Z,{label:e.formatMessage($.oldPasswordFieldLabel),name:"oldPassword",onChange:this.handleInputChange,value:this.state.oldPassword}),(0,M.Z)(T.Z,{label:e.formatMessage($.newPasswordFieldLabel),name:"newPassword",onChange:this.handleInputChange,value:this.state.newPassword}),(0,M.Z)(T.Z,{label:e.formatMessage($.confirmationFieldLabel),name:"confirmation",onChange:this.handleInputChange,value:this.state.confirmation}),(0,M.Z)("div",{className:"actions"},void 0,(0,M.Z)("button",{name:"button",type:"submit",className:"btn button button-primary"},void 0,e.formatMessage($.submit))))))},t}(N.ZP),(0,_.Z)(d,"propTypes",{dispatch:S().func.isRequired,intl:S().object.isRequired}),r=u))||r)||r,J=(0,A.$j)(U)(l=(0,F.ZP)(l=(0,j.EN)((p=c=function(e){function t(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];var s=e.apply(this,t)||this;return(0,_.Z)(s,"handleMfaClick",(function(e){s.props.history.push("../auth/mfa")})),s}return O(t,e),t.prototype.componentDidMount=function(){this.props.dispatch((0,E.PD)())},t.prototype.render=function(){var e=this.props,t=e.intl,a=e.mfa;return(0,M.Z)(x.NA,{},void 0,(0,M.Z)("h2",{},void 0,t.formatMessage($.mfaHeader)),a.getIn(["settings","totp"])?(0,M.Z)("div",{},void 0,(0,M.Z)("p",{className:"hint"},void 0,t.formatMessage($.mfa_enabled)),(0,M.Z)(I.Z,{className:"button button--destructive disable-mfa",text:t.formatMessage($.disable_mfa),onClick:this.handleMfaClick})):(0,M.Z)("div",{},void 0,(0,M.Z)("p",{className:"hint"},void 0,t.formatMessage($.mfa_setup_hint)),(0,M.Z)(I.Z,{className:"button button-secondary set-up-mfa",text:t.formatMessage($.mfa),onClick:this.handleMfaClick})))},t}(N.ZP),(0,_.Z)(c,"propTypes",{intl:S().object.isRequired,mfa:C().map.isRequired}),l=p))||l)||l)||l,B=(0,A.$j)(U)(f=(0,F.ZP)((m=h=function(e){function t(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];var s=e.apply(this,t)||this;return(0,_.Z)(s,"handleRevoke",(function(e){return function(t){s.props.dispatch((0,R._C)(e))}})),s}return O(t,e),t.prototype.componentDidMount=function(){this.props.dispatch((0,R.xt)())},t.prototype.render=function(){var e=this,t=this.props,a=t.tokens,s=t.intl;return a.isEmpty()?null:(0,M.Z)(x.NA,{},void 0,(0,M.Z)("h2",{},void 0,s.formatMessage($.tokenHeader)),(0,M.Z)("div",{className:"authtokens"},void 0,a.reverse().map((function(t,a){return(0,M.Z)("div",{className:"authtoken"},a,(0,M.Z)("div",{className:"authtoken__app-name"},void 0,t.get("app_name")),(0,M.Z)("div",{className:"authtoken__valid-until"},void 0,(0,M.Z)(L.Ji,{value:new Date(t.get("valid_until")),hour12:!1,year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})),(0,M.Z)("div",{className:"authtoken__revoke"},void 0,(0,M.Z)("button",{onClick:e.handleRevoke(t.get("id"))},void 0,e.props.intl.formatMessage($.revoke))))}))))},t}(N.ZP),(0,_.Z)(h,"propTypes",{dispatch:S().func.isRequired,intl:S().object.isRequired,tokens:C().list}),f=m))||f)||f,K=(0,A.$j)(U)(g=(0,F.ZP)((Z=v=function(e){function t(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];var s=e.apply(this,t)||this;return(0,_.Z)(s,"state",{password:"",isLoading:!1}),(0,_.Z)(s,"handleInputChange",(function(e){var t;s.setState(((t={})[e.target.name]=e.target.value,t))})),(0,_.Z)(s,"handleSubmit",(function(e){var t=s.state.password,a=s.props,i=a.dispatch,n=a.intl;return s.setState({isLoading:!0}),i((0,R.tm)(n,t)).then((function(){i(H.ZP.success(n.formatMessage($.deleteAccountSuccess)))})).catch((function(e){s.setState({password:""}),i(H.ZP.error(n.formatMessage($.deleteAccountFail)))})).then((function(){s.setState({isLoading:!1})}))})),s}return O(t,e),t.prototype.render=function(){var e=this.props.intl;return(0,M.Z)(x.NA,{onSubmit:this.handleSubmit},void 0,(0,M.Z)("h2",{},void 0,e.formatMessage($.deleteHeader)),(0,M.Z)("p",{className:"hint"},void 0,e.formatMessage($.deleteText)),(0,M.Z)("fieldset",{disabled:this.state.isLoading},void 0,(0,M.Z)(x.H_,{},void 0,(0,M.Z)(T.Z,{label:e.formatMessage($.passwordFieldLabel),name:"password",onChange:this.handleInputChange,value:this.state.password}),(0,M.Z)("div",{className:"actions"},void 0,(0,M.Z)("button",{name:"button",type:"submit",className:"btn button button-primary"},void 0,e.formatMessage($.deleteSubmit))))))},t}(N.ZP),(0,_.Z)(v,"propTypes",{dispatch:S().func.isRequired,intl:S().object.isRequired}),g=Z))||g)||g}}]);
//# sourceMappingURL=security-4de8f4b75f6efc21c8e5.chunk.js.map