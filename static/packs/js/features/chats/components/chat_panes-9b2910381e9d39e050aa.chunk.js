"use strict";(self.webpackChunksoapbox_fe=self.webpackChunksoapbox_fe||[]).push([[21],{1117:function(t,n,e){e.r(n),e.d(n,{default:function(){return D}});var o,a,i,r,c,s,u,p=e(1019),d=e(1018),l=(e(1),e(320)),h=e(3),f=e.n(h),g=e(0),Z=e(5),v=e.n(Z),_=e(4),w=e(1021),m=e(1797),y=e(1017),C=e(2),b=e(1794),S=e(49),I=e(50),N=e(9),j=e(652),P=e(791),k=e(1254),q=e(513),O=e(1800),R=e(21),x=e(182),T=e(11),E=e(12),W=e(17),M=e(55),F=e(1087),U=(o=function(t,n){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},o(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),$=(0,C.$j)((function(){var t=(0,E.dq)();return function(n,e){var o=e.chatId,a=n.getIn(["chats","items",o]);return{me:n.get("me"),chat:a?t(n,a.toJS()):void 0,displayFqn:(0,M.$X)(n)}}}))(a=(0,y.ZP)((r=i=function(t){function n(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var o=t.apply(this,n)||this;return(0,d.Z)(o,"state",{content:""}),(0,d.Z)(o,"handleChatClose",(function(t){return function(n){o.props.dispatch((0,I.wt)(t))}})),(0,d.Z)(o,"handleChatToggle",(function(t){return function(n){o.props.dispatch((0,I.w2)(t))}})),(0,d.Z)(o,"handleContentChange",(function(t){o.setState({content:t.target.value})})),(0,d.Z)(o,"handleInputRef",(function(t){o.inputElem=t,o.focusInput()})),(0,d.Z)(o,"focusInput",(function(){o.inputElem&&o.inputElem.focus()})),o}return U(n,t),n.prototype.componentDidUpdate=function(t){var n=t.windowState,e=this.props.windowState;n!==e&&"open"===e&&this.focusInput()},n.prototype.render=function(){var t=this.props,n=t.windowState,o=t.idx,a=t.chat,i=t.displayFqn;if(!a)return null;var r=a.get("account"),c=285*(o+1)+20,s=a.get("unread"),u=(0,p.Z)("i",{className:"icon-with-badge__badge"},void 0,(0,k.w8)(s)),d=(0,p.Z)(x.Z,{accountId:r.get("id")},void 0,(0,p.Z)(O.rU,{to:"/@".concat(r.get("acct"))},void 0,(0,p.Z)(R.Z,{account:r,size:18})));return(0,p.Z)("div",{className:"pane pane--".concat(n),style:{right:"".concat(c,"px")}},void 0,(0,p.Z)("div",{className:"pane__header"},void 0,s>0?u:d,(0,p.Z)("button",{className:"pane__title",onClick:this.handleChatToggle(a.get("id"))},void 0,"@",(0,W.F7)(r,i)),(0,p.Z)("div",{className:"pane__close"},void 0,(0,p.Z)(T.Z,{src:e(18),title:"Close chat",onClick:this.handleChatClose(a.get("id"))}))),(0,p.Z)("div",{className:"pane__content"},void 0,(0,p.Z)(F.Z,{chatId:a.get("id"),onSetInputRef:this.handleInputRef})))},n}(_.ZP),(0,d.Z)(i,"propTypes",{dispatch:f().func.isRequired,intl:f().object.isRequired,chatId:f().string.isRequired,windowState:f().string.isRequired,idx:f().number,chat:v().map,me:f().node,displayFqn:f().bool}),a=r))||a)||a,A=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),G=(0,m.vU)({searchPlaceholder:{id:"chats.search_placeholder",defaultMessage:"Start a chat withâ€¦"}}),z=function(t){return t.getIn(["chats","items"]).reduce((function(t,n){return t+Math.min(n.get("unread",0),1)}),0)},B=function(t,n){return void 0===n&&(n=(0,l.List)()),n.filter((function(n){return t.get(n.get("chat_id"))}))},D=(0,C.$j)((function(){return function(t){var n=(0,S.P1)([function(t){return t.getIn(["chats","items"])},function(t){return(0,N.Gw)(t).getIn(["chats","panes"])}],B);return{panes:n(t),mainWindowState:(0,N.Gw)(t).getIn(["chats","mainWindow"]),unreadCount:z(t)}}}))(c=(0,y.ZP)(c=(0,b.EN)((u=s=function(t){function n(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var o=t.apply(this,n)||this;return(0,d.Z)(o,"handleClickChat",(function(t){o.props.dispatch((0,I.WB)(t.get("id")))})),(0,d.Z)(o,"handleSuggestion",(function(t){o.props.dispatch((0,I.aU)(t,o.props.history))})),(0,d.Z)(o,"handleMainWindowToggle",(function(){o.props.dispatch((0,I.wv)())})),o}return A(n,t),n.prototype.render=function(){var t=this.props,n=t.intl,e=t.panes,o=t.mainWindowState,a=t.unreadCount,i="open"===o,r=(0,p.Z)("div",{className:"pane pane--main pane--".concat(o)},void 0,(0,p.Z)("div",{className:"pane__header"},void 0,a>0&&(0,p.Z)("i",{className:"icon-with-badge__badge"},void 0,(0,k.w8)(a)),(0,p.Z)("button",{className:"pane__title",onClick:this.handleMainWindowToggle},void 0,(0,p.Z)(w.Z,{id:"chat_panels.main_window.title",defaultMessage:"Chats"})),(0,p.Z)(P.Z,{})),(0,p.Z)("div",{className:"pane__content"},void 0,i&&g.createElement(g.Fragment,null,(0,p.Z)(q.Z,{onClickChat:this.handleClickChat}),(0,p.Z)(j.Z,{placeholder:n.formatMessage(G.searchPlaceholder),onSelected:this.handleSuggestion}))));return(0,p.Z)("div",{className:"chat-panes"},void 0,r,e.map((function(t,n){return(0,p.Z)($,{idx:n,chatId:t.get("chat_id"),windowState:t.get("state")},t.get("chat_id"))})))},n}(_.ZP),(0,d.Z)(s,"propTypes",{intl:f().object.isRequired,dispatch:f().func.isRequired,mainWindowState:f().string,panes:v().list,history:f().object}),c=u))||c)||c)||c}}]);
//# sourceMappingURL=chat_panes-9b2910381e9d39e050aa.chunk.js.map