"use strict";(self.webpackChunksoapbox_fe=self.webpackChunksoapbox_fe||[]).push([[12],{534:function(t,e,n){n.r(e),n.d(e,{default:function(){return J}});var o,r,a,i,s,c,u,d,p,l,m=n(1019),f=n(1018),g=(n(1),n(3)),h=n.n(g),v=n(5),Z=n.n(v),_=n(4),y=n(1797),M=n(1017),w=n(2),b=n(38),O=n(25),C=n(12),I=n(790),x=n(1021),P=n(1800),R=n(141),U=n(30),j=n(21),k=n(35),N=n(74),D=n(148),S=n(260),L=n.n(S),T=n(1022),A=n(105),E=n(136),q=n(34),z=(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),V=(0,y.vU)({viewStatus:{id:"admin.reports.actions.view_status",defaultMessage:"View post"},deleteStatus:{id:"admin.statuses.actions.delete_status",defaultMessage:"Delete post"}}),$=(0,w.$j)()(r=(0,M.ZP)((i=a=function(t){function e(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var r=t.apply(this,e)||this;return(0,f.Z)(r,"makeMenu",(function(){var t=r.props,e=t.intl,o=t.status,a=o.getIn(["account","acct"]);return[{text:e.formatMessage(V.viewStatus,{acct:"@".concat(a)}),to:"/@".concat(a,"/posts/").concat(o.get("id")),icon:n(429)},{text:e.formatMessage(V.deleteStatus,{acct:"@".concat(a)}),action:r.handleDeleteStatus,icon:n(60),destructive:!0}]})),(0,f.Z)(r,"getMedia",(function(){var t=r.props.status;if(t.get("media_attachments").size>0&&!t.get("media_attachments").some((function(t){return"unknown"===t.get("type")}))){if("video"===t.getIn(["media_attachments",0,"type"])){var e=t.getIn(["media_attachments",0]);return(0,m.Z)(E.Z,{fetchComponent:q.nk,loading:r.renderLoadingVideoPlayer},void 0,(function(n){return(0,m.Z)(n,{preview:e.get("preview_url"),blurhash:e.get("blurhash"),src:e.get("url"),alt:e.get("description"),aspectRatio:e.getIn(["meta","original","aspect"]),width:239,height:110,inline:!0,sensitive:t.get("sensitive"),onOpenVideo:L()})}))}if("audio"===t.getIn(["media_attachments",0,"type"])){var n=t.getIn(["media_attachments",0]);return(0,m.Z)(E.Z,{fetchComponent:q.Bb,loading:r.renderLoadingAudioPlayer},void 0,(function(e){return(0,m.Z)(e,{src:n.get("url"),alt:n.get("description"),inline:!0,sensitive:t.get("sensitive"),onOpenAudio:L()})}))}return(0,m.Z)(E.Z,{fetchComponent:q.ew,loading:r.renderLoadingMediaGallery},void 0,(function(e){return(0,m.Z)(e,{media:t.get("media_attachments"),sensitive:t.get("sensitive"),height:110,onOpenMedia:r.handleOpenMedia})}))}return null})),(0,f.Z)(r,"handleOpenMedia",(function(t,e){(0,r.props.dispatch)((0,T.h7)("MEDIA",{media:t,index:e}))})),(0,f.Z)(r,"handleDeleteStatus",(function(){var t=r.props,e=t.intl,n=t.dispatch,o=t.status.get("id");n((0,R.Uj)(e,o))})),r}return z(e,t),e.prototype.render=function(){var t=this.props.status,e=this.getMedia(),o=this.makeMenu();return(0,m.Z)("div",{className:"admin-report__status"},void 0,(0,m.Z)("div",{className:"admin-report__status-content"},void 0,(0,m.Z)(A.Z,{status:t}),e),(0,m.Z)("div",{className:"admin-report__status-actions"},void 0,(0,m.Z)(N.Z,{items:o,src:n(199),direction:"right"})))},e}(_.ZP),(0,f.Z)(a,"propTypes",{status:Z().map.isRequired,report:Z().map}),r=i))||r)||r,B=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),F=(0,y.vU)({reportClosed:{id:"admin.reports.report_closed_message",defaultMessage:"Report on @{name} was closed"},deactivateUser:{id:"admin.users.actions.deactivate_user",defaultMessage:"Deactivate @{name}"},deleteUser:{id:"admin.users.actions.delete_user",defaultMessage:"Delete @{name}"}}),G=(0,w.$j)()(s=(0,M.ZP)((u=c=function(t){function e(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var r=t.apply(this,e)||this;return(0,f.Z)(r,"state",{accordionExpanded:!1}),(0,f.Z)(r,"makeMenu",(function(){var t=r.props,e=t.intl,o=t.report;return[{text:e.formatMessage(F.deactivateUser,{name:o.getIn(["account","username"])}),action:r.handleDeactivateUser,icon:n(142)},{text:e.formatMessage(F.deleteUser,{name:o.getIn(["account","username"])}),action:r.handleDeleteUser,icon:n(191)}]})),(0,f.Z)(r,"handleCloseReport",(function(){var t=r.props,e=t.intl,n=t.dispatch,o=t.report;n((0,b.DI)([o.get("id")])).then((function(){var t=e.formatMessage(F.reportClosed,{name:o.getIn(["account","username"])});n(U.ZP.success(t))})).catch((function(){}))})),(0,f.Z)(r,"handleDeactivateUser",(function(){var t=r.props,e=t.intl,n=t.dispatch,o=t.report.getIn(["account","id"]);n((0,R.yM)(e,o,(function(){return r.handleCloseReport()})))})),(0,f.Z)(r,"handleDeleteUser",(function(){var t=r.props,e=t.intl,n=t.dispatch,o=t.report.getIn(["account","id"]);n((0,R.rx)(e,o,(function(){return r.handleCloseReport()})))})),(0,f.Z)(r,"handleAccordionToggle",(function(t){r.setState({accordionExpanded:t})})),r}return B(e,t),e.prototype.render=function(){var t=this.props.report,e=this.state.accordionExpanded,o=this.makeMenu(),r=t.get("statuses"),a=r.count(),i=t.getIn(["account","acct"]),s=t.getIn(["actor","acct"]);return(0,m.Z)("div",{className:"admin-report"},t.get("id"),(0,m.Z)("div",{className:"admin-report__avatar"},void 0,(0,m.Z)(P.rU,{to:"/@".concat(i),title:i},void 0,(0,m.Z)(j.Z,{account:t.get("account"),size:32}))),(0,m.Z)("div",{className:"admin-report__content"},void 0,(0,m.Z)("h4",{className:"admin-report__title"},void 0,(0,m.Z)(x.Z,{id:"admin.reports.report_title",defaultMessage:"Report on {acct}",values:{acct:(0,m.Z)(P.rU,{to:"/@".concat(i),title:i},void 0,"@",i)}})),(0,m.Z)("div",{className:"admin-report__statuses"},void 0,a>0&&(0,m.Z)(D.Z,{headline:"Reported posts (".concat(a,")"),expanded:e,onToggle:this.handleAccordionToggle},void 0,r.map((function(e){return(0,m.Z)($,{report:t,status:e},e.get("id"))})))),(0,m.Z)("div",{className:"admin-report__quote"},void 0,t.get("content","").length>0&&(0,m.Z)("blockquote",{className:"md",dangerouslySetInnerHTML:{__html:t.get("content")}}),(0,m.Z)("span",{className:"byline"},void 0,"â€” ",(0,m.Z)(P.rU,{to:"/@".concat(s),title:s},void 0,"@",s)))),(0,m.Z)("div",{className:"admin-report__actions"},void 0,(0,m.Z)(k.Z,{className:"button-alternative",size:30,onClick:this.handleCloseReport},void 0,(0,m.Z)(x.Z,{id:"admin.reports.actions.close",defaultMessage:"Close"})),(0,m.Z)(N.Z,{className:"admin-report__dropdown",items:o,src:n(199),direction:"right"})))},e}(_.ZP),(0,f.Z)(c,"propTypes",{report:Z().map.isRequired}),s=u))||s)||s,H=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),K=(0,y.vU)({heading:{id:"column.admin.reports",defaultMessage:"Reports"},modlog:{id:"column.admin.reports.menu.moderation_log",defaultMessage:"Moderation Log"},emptyMessage:{id:"admin.reports.empty_message",defaultMessage:"There are no open reports. If a user gets reported, they will show up here."}}),J=(0,w.$j)((function(t){var e=(0,C.Fg)();return{reports:t.getIn(["admin","openReports"]).toList().map((function(n){return e(t,n)}))}}))(d=(0,M.ZP)((l=p=function(t){function e(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var r=t.apply(this,e)||this;return(0,f.Z)(r,"state",{isLoading:!0}),(0,f.Z)(r,"makeColumnMenu",(function(){return[{text:r.props.intl.formatMessage(K.modlog),to:"/admin/log",icon:n(144)}]})),r}return H(e,t),e.prototype.componentDidMount=function(){var t=this;(0,this.props.dispatch)((0,b.RC)()).then((function(){return t.setState({isLoading:!1})})).catch((function(){}))},e.prototype.render=function(){var t=this.props,e=t.intl,n=t.reports,o=this.state.isLoading,r=o&&0===n.count();return(0,m.Z)(I.Z,{icon:"gavel",heading:e.formatMessage(K.heading),menu:this.makeColumnMenu()},void 0,(0,m.Z)(O.Z,{isLoading:o,showLoading:r,scrollKey:"admin-reports",emptyMessage:e.formatMessage(K.emptyMessage)},void 0,n.map((function(t){return(0,m.Z)(G,{report:t},t.get("id"))}))))},e}(_.ZP),(0,f.Z)(p,"propTypes",{intl:h().object.isRequired,reports:Z().list.isRequired}),d=l))||d)||d}}]);
//# sourceMappingURL=reports-c31591785b13e0bfa420.chunk.js.map