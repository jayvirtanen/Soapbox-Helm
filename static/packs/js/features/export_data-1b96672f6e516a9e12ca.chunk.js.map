{"version":3,"file":"packs/js/features/export_data-1b96672f6e516a9e12ca.chunk.js","mappings":"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","sources":["webpack://soapbox-fe/./app/soapbox/actions/export_data.js","webpack://soapbox-fe/./app/soapbox/features/export_data/components/csv_exporter.js","webpack://soapbox-fe/./app/soapbox/features/export_data/index.js"],"sourcesContent":["import\"core-js/modules/web.dom-collections.iterator.js\";import{defineMessages}from'react-intl';import snackbar from'soapbox/actions/snackbar';import api,{getLinks}from'../api';export const EXPORT_FOLLOWS_REQUEST='EXPORT_FOLLOWS_REQUEST';export const EXPORT_FOLLOWS_SUCCESS='EXPORT_FOLLOWS_SUCCESS';export const EXPORT_FOLLOWS_FAIL='EXPORT_FOLLOWS_FAIL';export const EXPORT_BLOCKS_REQUEST='EXPORT_BLOCKS_REQUEST';export const EXPORT_BLOCKS_SUCCESS='EXPORT_BLOCKS_SUCCESS';export const EXPORT_BLOCKS_FAIL='EXPORT_BLOCKS_FAIL';export const EXPORT_MUTES_REQUEST='EXPORT_MUTES_REQUEST';export const EXPORT_MUTES_SUCCESS='EXPORT_MUTES_SUCCESS';export const EXPORT_MUTES_FAIL='EXPORT_MUTES_FAIL';const messages=defineMessages({blocksSuccess:{\"id\":\"export_data.success.blocks\",\"defaultMessage\":\"Blocks exported successfully\"},followersSuccess:{\"id\":\"export_data.success.followers\",\"defaultMessage\":\"Followers exported successfully\"},mutesSuccess:{\"id\":\"export_data.success.mutes\",\"defaultMessage\":\"Mutes exported successfully\"}});function fileExport(content,fileName){const fileToDownload=document.createElement('a');fileToDownload.setAttribute('href','data:text/csv;charset=utf-8,'+encodeURIComponent(content));fileToDownload.setAttribute('download',fileName);fileToDownload.style.display='none';document.body.appendChild(fileToDownload);fileToDownload.click();document.body.removeChild(fileToDownload);}function listAccounts(state){return async apiResponse=>{const followings=apiResponse.data;let accounts=[];let next=getLinks(apiResponse).refs.find(link=>link.rel==='next');while(next){apiResponse=await api(state).get(next.uri);next=getLinks(apiResponse).refs.find(link=>link.rel==='next');Array.prototype.push.apply(followings,apiResponse.data);}accounts=followings.map(account=>account.fqn);return[...new Set(accounts)];};}export function exportFollows(intl){return(dispatch,getState)=>{dispatch({type:EXPORT_FOLLOWS_REQUEST});const me=getState().get('me');return api(getState).get(\"/api/v1/accounts/\".concat(me,\"/following?limit=40\")).then(listAccounts(getState)).then(followings=>{followings=followings.map(fqn=>fqn+',true');followings.unshift('Account address,Show boosts');fileExport(followings.join('\\n'),'export_followings.csv');dispatch(snackbar.success(intl.formatMessage(messages.followersSuccess)));dispatch({type:EXPORT_FOLLOWS_SUCCESS});}).catch(error=>{dispatch({type:EXPORT_FOLLOWS_FAIL,error});});};}export function exportBlocks(intl){return(dispatch,getState)=>{dispatch({type:EXPORT_BLOCKS_REQUEST});return api(getState).get('/api/v1/blocks?limit=40').then(listAccounts(getState)).then(blocks=>{fileExport(blocks.join('\\n'),'export_block.csv');dispatch(snackbar.success(intl.formatMessage(messages.blocksSuccess)));dispatch({type:EXPORT_BLOCKS_SUCCESS});}).catch(error=>{dispatch({type:EXPORT_BLOCKS_FAIL,error});});};}export function exportMutes(intl){return(dispatch,getState)=>{dispatch({type:EXPORT_MUTES_REQUEST});return api(getState).get('/api/v1/mutes?limit=40').then(listAccounts(getState)).then(mutes=>{fileExport(mutes.join('\\n'),'export_mutes.csv');dispatch(snackbar.success(intl.formatMessage(messages.mutesSuccess)));dispatch({type:EXPORT_MUTES_SUCCESS});}).catch(error=>{dispatch({type:EXPORT_MUTES_FAIL,error});});};}","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";var _dec,_class,_class2,_temp;import\"core-js/modules/web.dom-collections.iterator.js\";import PropTypes from'prop-types';import React from'react';import ImmutablePureComponent from'react-immutable-pure-component';import{injectIntl}from'react-intl';import{connect}from'react-redux';import{SimpleForm}from'soapbox/features/forms';let CSVExporter=(_dec=connect(),_dec(_class=injectIntl(_class=(_temp=_class2=class CSVExporter extends ImmutablePureComponent{constructor(...args){super(...args);_defineProperty(this,\"state\",{isLoading:false});_defineProperty(this,\"handleClick\",event=>{const{dispatch,action,intl}=this.props;this.setState({isLoading:true});dispatch(action(intl)).then(()=>{this.setState({isLoading:false});}).catch(error=>{this.setState({isLoading:false});});});}render(){const{intl,messages}=this.props;return/*#__PURE__*/_jsx(SimpleForm,{},void 0,/*#__PURE__*/_jsx(\"h2\",{className:\"export-title\"},void 0,intl.formatMessage(messages.input_label)),/*#__PURE__*/_jsx(\"div\",{},void 0,/*#__PURE__*/_jsx(\"p\",{className:\"export-hint hint\"},void 0,intl.formatMessage(messages.input_hint)),/*#__PURE__*/_jsx(\"button\",{name:\"button\",type:\"button\",className:\"button button-primary\",onClick:this.handleClick},void 0,intl.formatMessage(messages.submit))));}},_defineProperty(_class2,\"propTypes\",{action:PropTypes.func.isRequired,messages:PropTypes.object.isRequired,dispatch:PropTypes.func.isRequired,intl:PropTypes.object.isRequired}),_temp))||_class)||_class);export{CSVExporter as default};","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";var _dec,_class,_class2,_temp;import PropTypes from'prop-types';import React from'react';import ImmutablePureComponent from'react-immutable-pure-component';import{defineMessages,injectIntl}from'react-intl';import{connect}from'react-redux';import{exportFollows,exportBlocks,exportMutes}from'soapbox/actions/export_data';import{getFeatures}from'soapbox/utils/features';import Column from'../ui/components/column';import CSVExporter from'./components/csv_exporter';const messages=defineMessages({heading:{\"id\":\"column.export_data\",\"defaultMessage\":\"Export data\"},submit:{\"id\":\"export_data.actions.export\",\"defaultMessage\":\"Export\"}});const followMessages=defineMessages({input_label:{\"id\":\"export_data.follows_label\",\"defaultMessage\":\"Follows\"},input_hint:{\"id\":\"export_data.hints.follows\",\"defaultMessage\":\"Get a CSV file containing a list of followed accounts\"},submit:{\"id\":\"export_data.actions.export_follows\",\"defaultMessage\":\"Export follows\"}});const blockMessages=defineMessages({input_label:{\"id\":\"export_data.blocks_label\",\"defaultMessage\":\"Blocks\"},input_hint:{\"id\":\"export_data.hints.blocks\",\"defaultMessage\":\"Get a CSV file containing a list of blocked accounts\"},submit:{\"id\":\"export_data.actions.export_blocks\",\"defaultMessage\":\"Export blocks\"}});const muteMessages=defineMessages({input_label:{\"id\":\"export_data.mutes_label\",\"defaultMessage\":\"Mutes\"},input_hint:{\"id\":\"export_data.hints.mutes\",\"defaultMessage\":\"Get a CSV file containing a list of muted accounts\"},submit:{\"id\":\"export_data.actions.export_mutes\",\"defaultMessage\":\"Export mutes\"}});const mapStateToProps=state=>({features:getFeatures(state.get('instance'))});let ExportData=(_dec=connect(mapStateToProps),_dec(_class=injectIntl(_class=(_temp=_class2=class ExportData extends ImmutablePureComponent{render(){const{intl}=this.props;return/*#__PURE__*/_jsx(Column,{icon:\"cloud-download-alt\",heading:intl.formatMessage(messages.heading)},void 0,/*#__PURE__*/_jsx(CSVExporter,{action:exportFollows,messages:followMessages}),/*#__PURE__*/_jsx(CSVExporter,{action:exportBlocks,messages:blockMessages}),/*#__PURE__*/_jsx(CSVExporter,{action:exportMutes,messages:muteMessages}));}},_defineProperty(_class2,\"propTypes\",{intl:PropTypes.object.isRequired,features:PropTypes.object}),_temp))||_class)||_class);export{ExportData as default};"],"names":["messages","blocksSuccess","followersSuccess","mutesSuccess","fileExport","content","fileName","fileToDownload","document","createElement","setAttribute","encodeURIComponent","style","display","body","appendChild","click","removeChild","listAccounts","state","apiResponse","followings","data","accounts","next","refs","find","link","rel","api","get","uri","Array","prototype","push","apply","map","account","fqn","Set","exportFollows","intl","dispatch","getState","type","me","concat","then","unshift","join","snackbar","formatMessage","catch","error","exportBlocks","blocks","exportMutes","mutes","_class","_class2","_temp","CSVExporter","_dec","injectIntl","args","isLoading","event","props","action","setState","render","this","className","input_label","input_hint","name","onClick","handleClick","submit","heading","followMessages","blockMessages","muteMessages","ExportData","features","icon"],"sourceRoot":""}